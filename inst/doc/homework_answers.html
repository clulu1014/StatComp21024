<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Lu Cheng" />

<meta name="date" content="2021-12-20" />

<title>homework_answers</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>
<script src="data:application/javascript;base64,JChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXsKICAgIGlmICh0eXBlb2YgJCgnW2RhdGEtdG9nZ2xlPSJ0b29sdGlwIl0nKS50b29sdGlwID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgJCgnW2RhdGEtdG9nZ2xlPSJ0b29sdGlwIl0nKS50b29sdGlwKCk7CiAgICB9CiAgICBpZiAoJCgnW2RhdGEtdG9nZ2xlPSJwb3BvdmVyIl0nKS5wb3BvdmVyID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgJCgnW2RhdGEtdG9nZ2xlPSJwb3BvdmVyIl0nKS5wb3BvdmVyKCk7CiAgICB9Cn0pOwo="></script>
<link href="data:text/css,%0A%2Elightable%2Dminimal%20%7B%0Aborder%2Dcollapse%3A%20separate%3B%0Aborder%2Dspacing%3A%2016px%201px%3B%0Awidth%3A%20100%25%3B%0Amargin%2Dbottom%3A%2010px%3B%0A%7D%0A%2Elightable%2Dminimal%20td%20%7B%0Amargin%2Dleft%3A%205px%3B%0Amargin%2Dright%3A%205px%3B%0A%7D%0A%2Elightable%2Dminimal%20th%20%7B%0Amargin%2Dleft%3A%205px%3B%0Amargin%2Dright%3A%205px%3B%0A%7D%0A%2Elightable%2Dminimal%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%2300000050%3B%0Aempty%2Dcells%3A%20hide%3B%0A%7D%0A%2Elightable%2Dminimal%20tbody%20tr%3Afirst%2Dchild%20td%20%7B%0Apadding%2Dtop%3A%200%2E5em%3B%0A%7D%0A%2Elightable%2Dminimal%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dminimal%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dclassic%20%7B%0Aborder%2Dtop%3A%200%2E16em%20solid%20%23111111%3B%0Aborder%2Dbottom%3A%200%2E16em%20solid%20%23111111%3B%0Awidth%3A%20100%25%3B%0Amargin%2Dbottom%3A%2010px%3B%0Amargin%3A%2010px%205px%3B%0A%7D%0A%2Elightable%2Dclassic%20tfoot%20tr%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dclassic%20tfoot%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%200%2E14em%20solid%20%23111111%3B%0A%7D%0A%2Elightable%2Dclassic%20caption%20%7B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%20td%20%7B%0Apadding%2Dleft%3A%205px%3B%0Apadding%2Dright%3A%205px%3B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%20th%20%7B%0Apadding%2Dleft%3A%205px%3B%0Apadding%2Dright%3A%205px%3B%0Afont%2Dweight%3A%20normal%3B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Aborder%2Dbottom%3A%200%2E10em%20solid%20%23111111%3B%0A%7D%0A%2Elightable%2Dclassic%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23F9EEC1%3B%0A%7D%0A%2Elightable%2Dclassic%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20%7B%0Aborder%2Dtop%3A%203px%20double%20%23111111%3B%0Aborder%2Dbottom%3A%203px%20double%20%23111111%3B%0Awidth%3A%20100%25%3B%0Amargin%2Dbottom%3A%2010px%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20tfoot%20tr%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20tfoot%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%203px%20double%20%23111111%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20caption%20%7B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20td%20%7B%0Apadding%2Dleft%3A%205px%3B%0Apadding%2Dright%3A%205px%3B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20th%20%7B%0Apadding%2Dleft%3A%205px%3B%0Apadding%2Dright%3A%205px%3B%0Afont%2Dweight%3A%20normal%3B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20tbody%20tr%3Alast%2Dchild%20td%20%7B%0Aborder%2Dbottom%3A%203px%20double%20%23111111%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23111111%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23F9EEC1%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dmaterial%20%7B%0Amin%2Dwidth%3A%20100%25%3B%0Awhite%2Dspace%3A%20nowrap%3B%0Atable%2Dlayout%3A%20fixed%3B%0Afont%2Dfamily%3A%20Roboto%2C%20sans%2Dserif%3B%0Aborder%3A%201px%20solid%20%23EEE%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0Amargin%2Dbottom%3A%2010px%3B%0A%7D%0A%2Elightable%2Dmaterial%20tfoot%20tr%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dmaterial%20tfoot%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%201px%20solid%20%23EEE%3B%0A%7D%0A%2Elightable%2Dmaterial%20th%20%7B%0Aheight%3A%2056px%3B%0Apadding%2Dleft%3A%2016px%3B%0Apadding%2Dright%3A%2016px%3B%0A%7D%0A%2Elightable%2Dmaterial%20td%20%7B%0Aheight%3A%2052px%3B%0Apadding%2Dleft%3A%2016px%3B%0Apadding%2Dright%3A%2016px%3B%0Aborder%2Dtop%3A%201px%20solid%20%23eeeeee%3B%0A%7D%0A%2Elightable%2Dmaterial%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dmaterial%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dmaterial%2Elightable%2Dstriped%20tbody%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dmaterial%2Elightable%2Dstriped%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ddd%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%20%7B%0Amin%2Dwidth%3A%20100%25%3B%0Awhite%2Dspace%3A%20nowrap%3B%0Atable%2Dlayout%3A%20fixed%3B%0Afont%2Dfamily%3A%20Roboto%2C%20sans%2Dserif%3B%0Aborder%3A%201px%20solid%20%23FFFFFF12%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0Amargin%2Dbottom%3A%2010px%3B%0Abackground%2Dcolor%3A%20%23363640%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%20tfoot%20tr%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%20tfoot%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%201px%20solid%20%23FFFFFF12%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%20th%20%7B%0Aheight%3A%2056px%3B%0Apadding%2Dleft%3A%2016px%3B%0Apadding%2Dright%3A%2016px%3B%0Acolor%3A%20%23FFFFFF60%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%20td%20%7B%0Aheight%3A%2052px%3B%0Apadding%2Dleft%3A%2016px%3B%0Apadding%2Dright%3A%2016px%3B%0Acolor%3A%20%23FFFFFF%3B%0Aborder%2Dtop%3A%201px%20solid%20%23FFFFFF12%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF12%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF12%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%2Elightable%2Dstriped%20tbody%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%2Elightable%2Dstriped%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23FFFFFF12%3B%0A%7D%0A%2Elightable%2Dpaper%20%7B%0Awidth%3A%20100%25%3B%0Amargin%2Dbottom%3A%2010px%3B%0Acolor%3A%20%23444%3B%0A%7D%0A%2Elightable%2Dpaper%20tfoot%20tr%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dpaper%20tfoot%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%201px%20solid%20%2300000020%3B%0A%7D%0A%2Elightable%2Dpaper%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Acolor%3A%20%23666%3B%0Avertical%2Dalign%3A%20bottom%3B%0Aborder%2Dbottom%3A%201px%20solid%20%2300000020%3B%0Aline%2Dheight%3A%201%2E15em%3B%0Apadding%3A%2010px%205px%3B%0A%7D%0A%2Elightable%2Dpaper%20td%20%7B%0Avertical%2Dalign%3A%20middle%3B%0Aborder%2Dbottom%3A%201px%20solid%20%2300000010%3B%0Aline%2Dheight%3A%201%2E15em%3B%0Apadding%3A%207px%205px%3B%0A%7D%0A%2Elightable%2Dpaper%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23F9EEC1%3B%0A%7D%0A%2Elightable%2Dpaper%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%2300000008%3B%0A%7D%0A%2Elightable%2Dpaper%2Elightable%2Dstriped%20tbody%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">homework_answers</h1>
<h4 class="author">Lu Cheng</h4>
<h4 class="date">2021-12-20</h4>



<div id="section" class="section level2">
<h2>2021-09-16</h2>
<p>1.text</p>
<p>Compute the true value of the integral:</p>
<p><span class="math display">\[\begin{align*}
\int_{0}^{\pi/6}cos(t)= sin(t)|_{0}^{\pi/6}= &amp; sin(\pi/6)-sin(0)= \frac{1}{2}
\end{align*}\]</span></p>
<p>Estimate the integral with R:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;tseries&#39;是用R版本4.1.2 来建造的</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)  </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>M<span class="ot">&lt;-</span> <span class="dv">10000</span>  </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span> <span class="fu">runif</span>(M,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">6</span>)  </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>est<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">cos</span>(t))<span class="sc">*</span>(pi<span class="sc">/</span><span class="dv">6</span>)  </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>tru<span class="ot">&lt;-</span><span class="fu">sin</span>(pi<span class="sc">/</span><span class="dv">6</span>)<span class="sc">-</span><span class="fu">sin</span>(<span class="dv">0</span>)  </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(est,tru))  </span></code></pre></div>
<pre><code>## [1] 0.5000431 0.5000000</code></pre>
<p>The code above obtains the estimator and true value, and we can find that the average of simulated values for a large number of random variables should be close to 0.5.</p>
<p><br />
2.figure</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){z<span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span>)}</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span> y<span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>,<span class="at">length=</span><span class="dv">30</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span> <span class="fu">outer</span>(x,y,f)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(x,y,z,<span class="at">theta=</span><span class="dv">45</span>,<span class="at">phi=</span><span class="dv">30</span>,<span class="at">expand=</span><span class="fl">0.5</span>,<span class="at">ltheta=</span><span class="sc">-</span><span class="dv">100</span>,<span class="at">shade=</span><span class="fl">0.2</span>,<span class="at">col =</span> <span class="st">&quot;yellow&quot;</span>,<span class="at">main=</span><span class="st">&#39;Figure 1&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
3.table</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasets) </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;xtable&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xtable</span>(<span class="fu">head</span>(cars)) </span></code></pre></div>
<pre><code>## % latex table generated in R 4.1.1 by xtable 1.8-4 package
## % Mon Dec 20 10:47:49 2021
## \begin{table}[ht]
## \centering
## \begin{tabular}{rrr}
##   \hline
##  &amp; speed &amp; dist \\ 
##   \hline
## 1 &amp; 4.00 &amp; 2.00 \\ 
##   2 &amp; 4.00 &amp; 10.00 \\ 
##   3 &amp; 7.00 &amp; 4.00 \\ 
##   4 &amp; 7.00 &amp; 22.00 \\ 
##   5 &amp; 8.00 &amp; 16.00 \\ 
##   6 &amp; 9.00 &amp; 10.00 \\ 
##    \hline
## \end{tabular}
## \end{table}</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;kableExtra&quot;)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;kableExtra&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>tt<span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">cbind</span>(a,b))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tt,<span class="at">align=</span><span class="st">&#39;c&#39;</span>,<span class="at">caption =</span> <span class="st">&#39;Table 1&#39;</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">booktabs =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="st">&quot;responsive&quot;</span>,<span class="at">full_width =</span> F)<span class="sc">%&gt;%</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>), <span class="at">bold =</span> T, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">background =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<table class="table table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Table 1
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
a
</th>
<th style="text-align:center;">
b
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;color: white !important;background-color: blue !important;">
</td>
<td style="text-align:center;font-weight: bold;color: white !important;background-color: blue !important;">
Min. :-2.3457
</td>
<td style="text-align:center;font-weight: bold;color: white !important;background-color: blue !important;">
Min. :-2.85576
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
1st Qu.:-0.8953
</td>
<td style="text-align:center;">
1st Qu.:-0.55927
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;color: white !important;background-color: blue !important;">
</td>
<td style="text-align:center;font-weight: bold;color: white !important;background-color: blue !important;">
Median :-0.3846
</td>
<td style="text-align:center;font-weight: bold;color: white !important;background-color: blue !important;">
Median : 0.03280
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
Mean :-0.1568
</td>
<td style="text-align:center;">
Mean : 0.04124
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;color: white !important;background-color: blue !important;">
</td>
<td style="text-align:center;font-weight: bold;color: white !important;background-color: blue !important;">
3rd Qu.: 0.4712
</td>
<td style="text-align:center;font-weight: bold;color: white !important;background-color: blue !important;">
3rd Qu.: 0.62764
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
Max. : 2.5490
</td>
<td style="text-align:center;">
Max. : 3.04377
</td>
</tr>
</tbody>
</table>
</div>
<div id="section-1" class="section level2">
<h2>2021-09-23</h2>
<p>3.4<br />
Firstly, We assume <span class="math inline">\(\alpha=2\)</span>. Second, use the inverse transformation method to generate random variables. <span class="math display">\[\begin{align*}
F(x)=\int_0^xf(t)dt = \int_0^xe^{-\frac{t^2}{2\sigma}}d\left({\frac{t^2}{2\sigma}}\right)=1-e^{-\frac{x^2}{2\sigma}}:=U
\end{align*}\]</span> <span class="math inline">\(~~\Rightarrow\)</span> <span class="math display">\[\begin{align*}
x=\sqrt{-2\sigma^2\log(U)}
\end{align*}\]</span></p>
<p>Following the principle above, we give a generation procedure:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>U<span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(U))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob=</span>T,<span class="at">main=</span><span class="fu">expression</span>(<span class="fu">f</span>(x)))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x),<span class="fu">max</span>(x),<span class="at">length=</span>m)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As we can see, the figure including histogram and density line above suggests that the empirical and theoretical distribution approximately agree.<br />
<br />
</p>
<p>3.11</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>n2<span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n2,<span class="at">prob=</span><span class="fu">c</span>(p,<span class="dv">1</span><span class="sc">-</span>p),<span class="at">replace=</span>T)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span> r<span class="sc">*</span>x1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>x2</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z,<span class="at">main=</span><span class="st">&#39;histogram of z (p=0.75)&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAtFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2ZpC2kGa227a229u22/+2/7a2/9u2///T09PbkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v////herEnAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJv0lEQVR4nO2deWObNhyGSZfMXnZ0zdqtcXd0C92RbaXHghvz/b/XdGLAll6wAAt4nz9a24Ef4rFOEHJSEC/JuRMQOxQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBAgRFCWXNyZl7tNcvVQ++Pu938DQh9j92adJE+P/unxpkzJsf2S5OJ7m7o8Mcg9Mv1yVWzXTxzJHUrQp+euI56MOrVnjpQ0vp4KImlaQiWKFZRaQWKj45H7EnRAmvQuyH049+np3V4X75Lktv6hNPZ4U+7nVBwo6DeRfS/vyhz07lp8M9/cm69GKvrwIkk+0/l7p7ZV5sSevzxPntwXH56L7b66U2ldfbhOLl4W79YqoqUMkNqvXW2c7N/JXKGzw5M/xcaX4vDbdZlNRMpWKn2rSsrF32VyxX+3+09qBnsSpBFnrAVl5XsryHwiU6Oz+sX1/uOrh7w8UXvOybVVWzuGCOARlKkd0n3ZqQgyuSSt5ZBU7yoO/6X4fu6LWmbqVdDVvfz3mRYkc8FD8V5VFLqI6W9KbSFTs3rYpdab2PM/sdfnD3KjZ+qcn8l9k5dme0U1QKOIpYk9Z5M9ZOh7GWJVFaSiN4q8+GxlQpSeU0cZCxR0a9wrQeK4l3+VyddfqkpWqjOVfC221oJshv74x7U8JfG5SKD+15zTPkxhy+Vd7eD2rfxi9OneNlUUxTFBJgPtflyL8vhBFzdXpRleSavkKUG6EOkaJ90XPL2hfV07192PthnRJ6n/3QuqBqgLknmkUn9UHDQy2hFBRmj9NFxNQJ+CRNuus+yvJkE2JaJ03drXVUHS6OXPH2+cgqoBaqcg9yxPsu5AbusvYnm9ScvHEyS6Pz9d2yq1RQ7SiX90C3LmoLRakR/mIH8l3ShNowqSJ/VqX+O46yDbitwWZSV9RJCrDsqTRnHTDso6qN7Mi5RVm/myhG1frPdixxAkkv2tKmeq4ZF/c7diNgddPXzauOsgRyumm7ySfSVtW7FGKl/qjqL5Fsvw4r3oQ75fm72Hr6SLN/tmMwf9oLIO8lbS1X5QRVA5XFjZEzWCbDesyn6osRdkqiCT0UzRH6KZbxax97IGUh0v1W2+Nx3hH3RKxUdf3x+0YpevZT/PJagSwCnIjBNE5H9EPNmRrxsSg1w1WDWJrNTRn0Twi6cPhWe0MvrlDtc3FUI51Dh9+LddOwZ64wlK1bUK24ntFfH13wYKyocYrHZNQn0A1SeZtB4kKB3ickdHPr1Ym7F+7zzelP2I0xjmgtkioCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAN0E2ekYvc+BjpdOgjJ7fzb3TNyeGV0E7Tb7aTv9T9GIlC6CHm/KuY/5YgoZcxCgYx1kshDrIAf2IYnF5J9p9IOSBuMefNSjnUbytkbT17Cn0K0VkzVPPnpHsSnobeP9sAfvsK0SpNqvSoM/ApMSZNSM2sxPStB2rQQ1OorD1geTEgRy0NIF2en/uroODNeayQgqlKOLO09HevGCRg5nglIQCDodQfLpLV1JO7qKCxeUqRUAZC1NQcfQ14N2G/mQJAUdwQ4w0quHBQpqPG1/jPKKYrpaoCBdA/svFFot+tluEK4/YhFUYEf2mutus1BBWlHA1Z6ZC8oT/fz96dcy5ixIDkW1mYCbXjMW5F1Irnu4PolDUJThTNBIBIn+X/AdwTkLSlUFpIdaPYTrkTgE2XHESTX0Eq5J23GEaxDRMVyfxCHI9JK366BKaM6C9HJDgW39rAVFGM4EpSAQNA5BvcxgnbOgtI8pGzMW5LxZelq4PolFUB8zWmYsaLfpY/G1GQsS49QestCMBZVLgrMVqx886nAmKAWBoJEIUuulp7xg1jh4+Sq/uMvkwv0czdcPbl/I60GZZ1pCx3B9Eocg2VGUgsIedJqxIJuD0lPuGi7hkqupg7Kw7uKcBemuIq8oNg8edTgTlIJA0CgERTQWO3ggLApBhsDHmfsR1DQQk6AiPf+t57gFebMQvLC/AEG+oQZemmL+gnyzO1osLDBjQS0eiW+xNMWMBbVg2TmoDXhpihkLKjuKvkYKlsMZCzK3fWIYzccpaLfRZsKeiD+LoEGXqtgXse/0hY4JdhQHzVEHOch3RTHSjuI4guQVxUI/deki1mZ+JEG6ifLVQO6OYlj5B5c3ohEEGSoHwTOeiqChOopTEdTi1vMwHcWJCDrfredpCDrjredpCDrjredpCAq69XwYrtNOkxDU4tZziwH/nAW1uPXsfFz+WDjfVp06htEIagGcK9xSUMczjkJQpZvsAc0VnrGgMWfaT1JQP2toz1jQmJMXJilozHAUhLaanKDeVvedtaB2DX2bcHArCgJbLU5Qx2vSyxPUCAe3oiCwFQWBrSYoqMXUjvbh4FaTEzRyOApCW1FQ49OOU+eXJyjwjCmIgijIG46CQDgKAuEoCIQbWVCvk17nKKjxdogzcnHiNODFCGo7DbjvWZlTEdR6EufAZxytoNbTgA9yUFQMJ4g/ZYzgTxkj+FPGpMkogqZUKR+kvR8FQQdBaQjbnYIoiIIG3Z2CKIiCBt2dgiho/oKmDAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgKMIUhNmnHdis39qz1499X4VhuRP40a9rtpIwjabYSBzJFOubRc7jbk3ddE8NznzcWfYvz16jrbtVri8+ikKz0fwr0Kum9fjVo3y/E3HT3CH+M5xvFsggW499VkV6+cgrZfhP1KiGQ0Qcd/pVSfAlr0wfMLpyKAuw7Kn/x9g2owxFiCHBNmdN7w5RD3vhJZiNyCMjmZMvDXLUcSlHvqaCTIta/Ev2aWXlY0wt+7OsCZB1oUMd9kLbW7R5CKq+u5UxlWUKY7MZnzHHEl7d7XxJc4DGjxYVX1GDnIsy4aaubbLADuzkF61mn0RWy79uQB0FH07mvw9KRlFRX4MPcIgkw5cFjIvEMN/74a31AjhwMVBAerAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQOyC9PyXM66YFrsgSdhM8EAmIChsEmYo8Qvabc665l78gjL/LPOhiV5Qm2mcQxK7oDMXsPgFnbmARS/IrvB9vnYsckHnh4IAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAvwPm078bbrtfkkAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>P<span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(3,4))</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> P){r<span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n2,<span class="at">prob=</span><span class="fu">c</span>(p,<span class="dv">1</span><span class="sc">-</span>p),<span class="at">replace=</span>T)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>zp<span class="ot">&lt;-</span> r<span class="sc">*</span>x1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>x2</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(zp,<span class="at">main=</span><span class="fu">bquote</span>(<span class="st">&#39;histogram of z :p=&#39;</span><span class="sc">*</span>.(p)))}</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAtFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6OmY6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmZgBmkJBmkLZmkNtmtttmtv+QOgCQZgCQZjqQZmaQkGaQtpCQttuQ2/+2ZgC2Zjq2kDq2kGa2tra2ttu22/+2/9u2///T09PbkDrbkGbbtmbbtpDb27bb29vb2//b/9vb////tmb/25D/27b/29v//7b//9v///9Itf0eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAI9UlEQVR4nO2da2PTNgBFlUJrYIM162CQdWOYjRUwj40mJfH//1/Ty4mb2L5SLCeSc88HyEOS5VO9bMmKKEkn4tgZiB0KAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMAAglaz89vtV4bv4Q6yvBLilWec1d+ZmLy4xQHrHFLQp8cfgh0kF2Lyxj+O5MIv0qCCtsjPgglazfzTmouHN+XdlWfBS1ZQyzE6yHWRW2R+RWgYQd9mYvKrPY3V20yIH27kG1O+767l+6c3KqT8c4qHf2SX8ruLQpzdlJ+fCNNK5OffrlUSq2shnq1VrKPON3VFv9zUt0K9yM/ev9XHLJdT87U4+2Cd+qodRNDDK5WnS5OZ3J6AFbTIbIbL6qUO+CAT57dF9V4K+k29ejmz7zWbqFDQL/azmqDl1ETwLMeDCBLnN+UneQJK0HKq/mKf9VmrrOWqRKze6m/FT7fll0wLUt8vp7IQlYuptiqTkF/Jfz+L6k++ibpdDvK1RPt28qcNuCEmQeqvqMQYQZOn7/5bZ8340o2sbQ3mWpDN9b/vfn+ihOj2wny6dlGLuiWoEM/u5cC0NlsNeUyCVObVv/qVrjemYZFZW2Tmby2rwtz0J4vssjpfW4eUoI2atYta1PuCiu2u2zqQASOtYvcElV+va2fdJUiezY8v/vk69RQ0F9vNbqOgmBrp+4Ik379cybPqqmLqU2Ns2SaopYrt+mmuYlF18zVBMkOyBbpT7ZLOYUsjbQRd3Kquv0VQcyO9yHarTK6GhNuNdGwDxXUJMt28ymxR6+aVq3o3b6tY1Y83CqpFXX+oBw+2CitMNz95Ug0l6sR1qbEWpC4RxYOXpb7AlO/vZJM0eab7NT1QfL1ppNX7By9zWxt3BNWiAkFn72XIp9s1b/VXHBernlRtb0ACXtMcU9ByKtsEWWq8r8ohIxFUa51CJzwSQZvWKTBjEZQEFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQwE9QtVQg4MRc7HgJKqq1knMRfMFBrPgIWs3WWgr/ddyJ4iNoOV0vzpqfTCVjCQJ4tkG2CLENaqFaRXgy5YfjIAgFAaIdKIoagx+sKx8+gQ85UBQf1yQjaPBuvl5qUhTUPlAMVBtqUj6mKMihBJ22IIeB4okLwgPFUxc0cHIUhGInL0g9f6qboaJlqHjiggr9JLp6+ISCmjDdvHmUmYIaqAaK+fktBTWxHijmFxTUSKVFDodOT5A8afzoXzWUbt2+Z8SCTB/e9y7GqAWVARyNXZBR1ON+4cgFzfVAeZ/trxqT848dtSB1pW7M9Jg2HbGg5TTEA/4jFhRDcpELklcQvacrxiwo1w1QtZFV7+T2ih2zoOpKtN/ClhELqq5E2y5DPZPbL3bMgux1Vs/dfMYsyOyAtV9fz4nDwyRHQSh21IKCLG3Z41yaFyxEKCjItk37CGqUEp+g5TTEkp9RC/LdQ78zOY8oiQhazULsRjdiQXar2WDJuUdJRFBtY+EQyXlESUTQ0ZKjIBQFCzrmiuDaEWUlO7/ND37DzEHQMQtTrZGevCnUHv1dhuBoe8SC1P2gomNhiwIvJB+xIDVQVII67igOsww4FUFVCcrbZw0dnjgcsSDbBhUdw8XTLkF2qNh5R3GQheTpCHJgiIXkoxI0RHKpCIr5WiwKQZbuecNTHihW5B23hU56oFgR+UDx4NetO4fpuNQY5olDP0EHL0zbh+la3RFDCTqeIJdNFSIYKB69BHVz/IFi5IKGSC4VQeuBYq+x4ogF2Wmfrqt5r+RAuOYdBGIWtJoZM/32VHAWhE4/PkHLn82Njo6BokMtHLGgqgR13FFsfwpqNzl02PQEqTuKpf0RxVbgBP6YBZkaBFogNIE/akGHTI6CULgUBR1y6jlFQS5Tzx7JgXDpCXKZevZIDoVLT5DD1LNPcihceoIcpp59kkPh0hPkMPXslRwIl6Agh6lnr+S6w6Uo6JDJJSiodkc+RHIoXHqCDrvSPkFBYXZhP6Sgw8whhlm84J3VEIIOU5gSbqQpKCJBYVroEgiCUxmRCwrR0XcL8jhnCqKghi8piILckmv7koJGLCjE0o5yvIIOkxwFUVC/5CiIgvolR0EU1C85CjqaoAHvvo5DUO1l2POhoH5nFDi5ExC0xxOHPvdZkxfk+sSh2NNK6oKcnxcLcKJ7Cwrdo/kk4vzEoYia4QTxx7AR/DFsBH8Mm2wziKDjNsKIGAT5fBwgcIjjtUFBAAoCUBCAggAUBKAgAAUBKAjASw0ABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAgwiqPDbwWHx2PXph4aQekVOwzxvax48NycZQpDaYWfubmg5dX08pCHkaiYPVIidveda8zD3nBYeQJDeo8n9B+/mzs/PNIVcZHr/0O3PW/Ogt9lyzJlmqDbIWdBcXDpuadARsrm8NuWhOP8tDkHd+zHex33Ph7aQzT+B2pCHxaM3EbRBujJ4rI/pLahxNU5THtQKpygEqay456OvoPluG92Shz222BpsHOTRjfUU1L6aazsPsoIduZsvNmMS0704Be4nqGivzdt5KOwCGJ9tJgYoQSZbHrvt9BLUvOlaRx4iqGIqCz6PUPcRtMiaj9OehwgElblfMe4jyNaa3QavNQ8xCBoTFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGAmAWZpS2Xi0evM69FoUGJWZCiOPuwyMQr+DPlgxG5ILWUziwiO9bGhHEL0gt57XrDnj9wui9xC9Jr5fXiXQpqwlQuCmrDrpQ3mvr9BvX+xCzIPoyyyOT/7MV2qXb3fp49z/xWx4ckYkEV+KGGIaEgAAUBEhB0XCgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQ4H+cziI+kmWzZgAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAvVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmZgBmkJBmkLZmkNtmtttmtv+QOgCQZgCQZjqQZmaQkGaQtpCQttuQ2/+2ZgC2Zjq2kDq2kGa2tra2ttu22/+2/7a2/9u2///T09PbkDrbkGbbtmbbtpDb25Db27bb29vb2//b/9vb////tmb/25D/27b/29v//7b//9v///+2FjyPAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJGUlEQVR4nO2da5uTRhiG2dVdrG21m1qtxm2t2NqtFrW2LlkT/v/P6pwgnGYeEg6B4bk/7LUQ5g3cmRMwDEFKnASn3oGpQ0EACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQE6FHQbn1xW/1P87W/L9k+CYIXB6bZ/REGZ8/2e7S7DkrLTsYQ9OGb9719SSSO7fXhaQSX2aJ0XFx2M4igCtF5b4J268NjJcH9m/TuSZ7x4uDxrVhu6Xl2gizf4SBSKjbhZSlE3LKk9ivoyzo4+9nsw+5NGATf3YgFnZ/vrsXyoxu5pfg5g/u/hlfis8s4OL9JPz40tUJ08eVahpDVxONcRZ402ZcN9e++vMXyn+j83Rv1nel2pT8Ozt8bIRW1/6xa/mq9CrqvSveV3pnIHIARtAnNDqfZv2rDe2FwcRtny0LQS/nf87VZVuyTQkE/mXUFQduVTlDMx+ILL27aHVWvguS3fhAHIAVtV/IX+6iOWu5aJHPE7o36NPjhNv0UKkHy8+1KZKJ0s1JWRQjxkfj7Mch+8n3Saj6Icolm8ew3s+GeJkHRt0HQsqz2Kkj+ilKMFnT26O1/+a5pX6qSNbVBogSZvf737S8P5S6r+kKvzV0UklYEieq2tAe6tqlU5E2CVNp2zVjvlbT8q/5T5UZXLGLXNqH+rUVRSHT1uAmvsuM1ZUgK2qvJXRSSlgXVjtE4EBuCIpa2bw+HE5R+vi4ctUuQOJrvn/35eXWgoKRWShoFNVfSrdvWAQUJvn6S3Q1XEZNrtbGtTZCliNX9NBexajNvwm1bNmODCRI7JGqgO1kvqT20VNJa0KXsudmKWHMlvQnrBxjJLmG1kq51FFW4u3W5frcyXA7Szbzc2bjQzEtXxWbeFLGsHW8UVEiar1SdB1OEJbqZP3uYdSWK7E81Yt2MFBMihhMkTxGDe89TdfIjlu/kKeJj1a6pjuKrfSUtl+89j0xprAkqJAWCzt+JLR9Vj3z3e3ayGusyeKKT1QPJ6t4e6fGcJucEgrYrUSe0P1s8AE8EFWqnvgN7ImhfO/WML4JmBQUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMAUBAVVTr1DRaawM8HfZaawTzn97Ey3H38BgrqFoyCUiIJAIgoCiSgIJKIgkIiCqltVoKDqVhUh/gjKHmOzPjSycEFx9pxnYnvgc9mCdutcS2x54nPZgrarfMKUxFLIPBa0XcFHAJeeg+LChCvN5HPuLLYOQo6yJ9ytz5z7Lkgr6vDkp+eC5KRFL46aBqsxnH2rWQqSxUebsTVRy+4oblf4QX92FN0svZmPxEFbs4bE3lE88KL9PAVFZt4he3dx2Tkoyx72GnrhHcUse8SuXtCiO4o6e3Sc1cdnQXomrI6T+ngtqAVxYGZzthXEhQuK1Sypara0BQqCpxGmHtfTbC5QEJ6+KesJiB7TAgVtV7D5yjuK0eUiBeEZujMtoju0PEG7dYtZ6bKutHUqXY8FmSlnewvn3GqOggoTDPcRzr3VHAWNGY6C0FbzFCQK2cVt1G0GWp8FJWevYzlXP8/mS5SuB8WOk4gDw7m3mqMg2VGUglxXFO1RFnBNOstB0fF3DVOvc5Cpg9q+EwiGc24FBE3p4ZZyKzaRK4pTylGT7AdR0BwFTelcbJKCDEe18vZwlq1mLCiNXJeFRhr+MmlB7lvP4wx/mbQgx6nGaIMXpizINbpjtHHSkxQExyUwB2HGGv4yW0FjDX+ZpKC8o9ipr+ixIHPbZxJn825B457sF64HaTO26tdsNIGO4rgZbF/EftQXOqbYUTzlI661HOS4oniyZv6gDNYzpSuKafaaxGaOHiddqzVmKUi3Y+4a6MgcdOgRT1QQ5tiO4mIEHdtR9ETQcLee/RA04K1nLwQNeevZC0Gdbj3Xw5XX+iCoxa3nFuezHgtqc+vZOnazIVxprReC2tx6hkNhvRbUBjQU1mNBhfOIPsKV1/ogqM1I+wPCldf6IKjrTedquNJaHwQNOXjBC0FDhqMgEG7+gvqpoVPPBfXR0FOQJQq4Jr14QZVwtbUUVA5XW0tB5XC1tcMKGvRWtA+Cqsudj6J+RP0M7Uj9FTRwOAoC4SgIhKMgEI6CQDgKAuEoCISjIBCOgkA4CgLhKAiEW46gI8dJL0ZQ23HSYFSrt4Jaj3Lt+4jnIqj1OOlaDpoUwwlqkYP8o+dx0v7R8zhp/xj2loAHjCJoTpVybd/7UdDpS9A+dEtOQRREQYMmpyAKoqBBk1MQBfkvaM5QEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgwBiC1KAZ263YxD3bgzOtxvWiC/lq1BbvTXMwgqDdWhiILfspp5ZL7IacaU0Ex33eRHzkmt+4BSMI2oRqis/GQVd6PIR9FnRXWo2aN8vymY4+xst4eqA5m2AB9rSa+OKlVdDmQbe3hEhGE9T8llJ9CGjSB8cbTkUAex2UnP+1QjUYYixBlgEzOm+4cog9rUQWIrugWA6mbPV2SzsjCUocdTQSZEsrcc+ZpacVHWLSsb6x5oEWRcw1WEsldwhScXU9dyzDCop1Jya2HiOupO1pTXyJxYAW362qHiMHOeZFQ818mwnA7TlIjzqdfBHbhI48ADqKzrQGR09aVlEdH+YeQZApBxYLsfNUw51W4zrVSOCJCoInqwAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMCUBemxL1ebB6/CroNYjmfKgiTx+ftNGLyAL1ccjIkLkmMY9SizU01MOG1Bu7XQogd6grHUgzFtQWqgsxkqTEF1dOGiIBuqgGWaXEM1h2TKgvSTBEKQHCrMVqxGNrv30/BpaB1MPzgTFpTR7VmLrlAQgIIAMxB0WigIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQ4H/bBpvVei4UVAAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>We observe the figures that generated with different <span class="math inline">\(p\)</span> above, and we can find that the bimodal phenomenon is obvious when the <span class="math inline">\(p\)</span> is equal to 0.5.</p>
<p><br />
</p>
<p>3.20</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>lamada<span class="ot">&lt;-</span> <span class="dv">8</span> <span class="co">#the parameter of Poisson process</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span> <span class="dv">4</span>  <span class="co">#the parameter1 of Gamma distribution</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co">#the parameter2 of Gamma distribution</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>n3<span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span> <span class="fu">rpois</span>(n3,lamada<span class="sc">*</span>t)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>x10<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n3)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n3){Y<span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N[i],alpha,beta)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>x10[i]<span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)}</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># theoretical values</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>Ex10<span class="ot">&lt;-</span> lamada<span class="sc">*</span>t<span class="sc">*</span>alpha<span class="sc">/</span>beta</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>Vx10<span class="ot">&lt;-</span> lamada<span class="sc">*</span>t<span class="sc">*</span>(alpha<span class="sc">/</span>beta<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(alpha<span class="sc">/</span>beta)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;knitr&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>value<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">statistics=</span><span class="fu">c</span>(<span class="st">&quot;sample mean&quot;</span>,<span class="st">&quot;sample variance&quot;</span>,<span class="st">&quot;population expect&quot;</span>,<span class="st">&quot;population variance&quot;</span>),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">values=</span><span class="fu">c</span>(<span class="fu">mean</span>(x10),<span class="fu">var</span>(x10),Ex10,Vx10))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(value,<span class="at">align=</span><span class="st">&#39;l&#39;</span>,<span class="at">full_width =</span> T) </span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
statistics
</th>
<th style="text-align:left;">
values
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
sample mean
</td>
<td style="text-align:left;">
106.6683
</td>
</tr>
<tr>
<td style="text-align:left;">
sample variance
</td>
<td style="text-align:left;">
178.9375
</td>
</tr>
<tr>
<td style="text-align:left;">
population expect
</td>
<td style="text-align:left;">
106.6667
</td>
</tr>
<tr>
<td style="text-align:left;">
population variance
</td>
<td style="text-align:left;">
177.7778
</td>
</tr>
</tbody>
</table>
<p><br />
From the result of the procedure, we can obtain that the sample mean and variance is very close to the theoretical values when the time of loop and the number of sample are enough.<br />
<br />
</p>
</div>
<div id="section-2" class="section level2">
<h2>2021-09-30</h2>
<p><strong>The primary work:</strong></p>
<p>We all know that the pdf of the Beta distribution is <span class="math display">\[\begin{align*}
f(x;\alpha,\beta)=\frac{1}{B(\alpha,\beta)}x^{\alpha-1}(1-x)^{\beta-1}
\end{align*}\]</span> where, <span class="math inline">\(B(\alpha,\beta)=\int_0^1t^{\alpha-1}(1-t)^{\beta-1}dt\)</span>.</p>
<p>In this case, <span class="math inline">\(\alpha=3,\beta=3\)</span>, so the equation can be simplifed: <span class="math display">\[\begin{align*}
B(3,3)=\int_0^1t^2(1-t)^2dt=\frac{1}{30} ~\rightarrow~ f(x;3,3)=30x^2(1-x)^2
\end{align*}\]</span></p>
<p>Then, we aim to compute the cdf of the Beta(3,3) <span class="math display">\[\begin{align*}
\int_0^x f(t;3,3)dt=\int_0^x 30t^2(1-t)^2dt=\int_0^x \frac{1}{x}[x(30t^2(1-t)^2)]dt=E[x(30t^2(1-t)^2)],
\end{align*}\]</span> where <span class="math inline">\(t\sim U(0,x)\)</span>.<br />
</p>
<p><strong>The flowchart before programming:</strong></p>
<p><em>step1.</em> Ensure the value of <span class="math inline">\(x\)</span>.</p>
<p><em>step2.</em> Generate t from the U(0,<span class="math inline">\(x\)</span>).</p>
<p><em>step3.</em> Use a frequency to approximate the expectation.<br />
</p>
<p><strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="at">length=</span><span class="dv">9</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>betacdf<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  t<span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,x[i])</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  betacdf[i]<span class="ot">&lt;-</span> x[i]<span class="sc">*</span><span class="fu">mean</span>(<span class="dv">30</span><span class="sc">*</span>t<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>pbeta<span class="ot">&lt;-</span> <span class="fu">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(pbeta,betacdf)</span></code></pre></div>
<pre><code>##         pbeta     betacdf
##  [1,] 0.00856 0.008475261
##  [2,] 0.05792 0.057290626
##  [3,] 0.16308 0.163519873
##  [4,] 0.31744 0.311372412
##  [5,] 0.50000 0.499624347
##  [6,] 0.68256 0.683693890
##  [7,] 0.83692 0.836149705
##  [8,] 0.94208 0.939352039
##  [9,] 0.99144 0.999296175</code></pre>
<p>From the result above, the estimates are close to the values returned by the <strong>pbeta</strong> function in R.<br />
<br />
</p>
<p>5.9<br />
<strong>The primary work:</strong></p>
<p>Firstly, We assume the problem is to estimate the following function. <span class="math display">\[\begin{align*}
\phi(x)=\int_0^x\frac{t}{\sigma^2}e^{-t^2/(2\sigma^2)}dt.
\end{align*}\]</span></p>
<p>The simple estimator is</p>
<p><span class="math display">\[\begin{align*}
\hat{\eta}=\frac{1}{m}\sum_{i=1}^{m}x\frac{t}{\sigma^2}e^{-t^2/(2\sigma^2)},~t\sim U(0,x)
\end{align*}\]</span></p>
<p>Then, the antithetic variable estimator is</p>
<p><span class="math display">\[\begin{align*}
\hat{\eta}&#39;=\frac{1}{m}\sum_{i=1}^{m/2}x(\frac{t}{\sigma^2}e^{-t^2/(2\sigma^2)}+\frac{x-t}{\sigma^2}e^{-(x-t)^2/(2\sigma^2)}),~t\sim U(0,x)
\end{align*}\]</span></p>
<p><strong>The flowchart before programming:</strong></p>
<p><em>step1.</em> Assume <span class="math inline">\(\sigma=1\)</span> and the upper of integration <span class="math inline">\(x=1\)</span>.</p>
<p><em>step2.</em> Generate independent random variables (<span class="math inline">\(t1,t2\)</span>) and antithetic variables (<span class="math inline">\(t1,t3\)</span>).</p>
<p><em>step3.</em> Estimate the integration using the different data.</p>
<p>We give two methods to solve the question:<br />
<br />
<strong>The R procedure 1:</strong></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the function to calculate the integral value estimated by the two methods</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>ant <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma, <span class="at">R =</span> <span class="dv">10000</span>, <span class="at">antithetic =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  t1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,x)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>antithetic) t2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>) <span class="cf">else</span> t2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> t1</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">c</span>(t1, t2)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  cdf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> x[i] <span class="sc">*</span> t<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>t<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    cdf[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(g)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  cdf</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>MC1 <span class="ot">&lt;-</span> MC2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  MC1[i] <span class="ot">&lt;-</span> <span class="fu">ant</span>(x, sigma,<span class="at">R =</span> <span class="dv">1000</span>, <span class="at">anti =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  MC2[i] <span class="ot">&lt;-</span> <span class="fu">ant</span>(x, sigma,<span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(MC1) <span class="co">#Integral calculated by simple random number sample</span></span></code></pre></div>
<pre><code>## [1] 0.3932727</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(MC2) <span class="co">#Integral calculated by opposing a sample of random numbers</span></span></code></pre></div>
<pre><code>## [1] 0.3934375</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>redu_var<span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>(<span class="fu">var</span>(MC1)<span class="sc">-</span><span class="fu">var</span>(MC2))<span class="sc">/</span><span class="fu">var</span>(MC1) <span class="co">#Calculate the percentage of variance reduction using the opposite method</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(redu_var)</span></code></pre></div>
<pre><code>## [1] 90.08605</code></pre>
<p><strong>The R procedure 2:</strong></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the calculation process of the estimated integral directly in the loop</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>n3<span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>eta_sim<span class="ot">&lt;-</span>eta_ant<span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#Set the upper limit of points</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>t1<span class="ot">&lt;-</span> <span class="fu">runif</span>(n3<span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,x) </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>t2<span class="ot">&lt;-</span> <span class="fu">runif</span>(n3<span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,x) </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>t3<span class="ot">&lt;-</span> x<span class="sc">-</span>t1 </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>u1<span class="ot">&lt;-</span> <span class="fu">c</span>(t1,t2) </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>u2<span class="ot">&lt;-</span> <span class="fu">c</span>(t1,t3) </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>eta_sim[i]<span class="ot">&lt;-</span> <span class="fu">mean</span>(x<span class="sc">*</span>u1<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>u1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>eta_ant[i]<span class="ot">&lt;-</span> <span class="fu">mean</span>(x<span class="sc">*</span>u2<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>u2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(eta_sim) </span></code></pre></div>
<pre><code>## [1] 0.3934417</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(eta_ant) </span></code></pre></div>
<pre><code>## [1] 0.3934797</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>redu_var<span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>(<span class="fu">var</span>(eta_sim)<span class="sc">-</span><span class="fu">var</span>(eta_ant))<span class="sc">/</span><span class="fu">var</span>(eta_sim) </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(redu_var)</span></code></pre></div>
<pre><code>## [1] 89.53913</code></pre>
<p>The function we construct is a integration and the estimator value is about 0.393.</p>
<p>The antithetic variable approach achieve approximately 89%~92% (every Running gets different result) reduction in variance in two methods at <span class="math inline">\(x=1\)</span>.<br />
<br />
</p>
<p>5.13</p>
<p><strong>The primary work:</strong></p>
<p>We choose the two important functions, assume <span class="math inline">\(f_1\)</span> is standard normal distribution density and <span class="math inline">\(f_2\)</span> is Rayleigh density:</p>
<p><span class="math display">\[\begin{align*}
f_1(x)=\frac{1}{\sqrt{2\pi}}e^{-x^2/2},~f_2(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},\sigma=1
\end{align*}\]</span></p>
<p><span class="math display">\[\begin{align*}
est1=\int_1^\infty\frac{g(x_1)}{f_1(x_1)}f_1(x_1)dx=E(g(x_1)/f_1(x_1))=E(x_1^2),~where~x_1~has~pdf~f_1(x)\\
est2=\int_1^\infty\frac{g(x_2)}{f_2(x_2)}f_2(x_2)dx=E(g(x_2)/f_2(x_2))=E(\frac{x_2}{\sqrt{2\pi}}),~where~x_2~has~pdf~f_2(x),

\end{align*}\]</span></p>
<p><strong>The flowchart before programming:</strong></p>
<p><em>step1.</em> Assume <span class="math inline">\(\sigma=1\)</span>.</p>
<p><em>step2.</em> Generate random variables in two distributions and select the value which we need.</p>
<p><em>step3.</em> Estimate the integration using Mc by importance sampling.</p>
<p><strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>theta_hat<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>se<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># f1</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m) </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which</span>(x1<span class="sc">&lt;</span><span class="dv">1</span>)) </span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>x1[i]<span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>fg1<span class="ot">&lt;-</span> x1<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>theta_hat[<span class="dv">1</span>]<span class="ot">&lt;-</span> <span class="fu">mean</span>(fg1)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">1</span>]<span class="ot">&lt;-</span> <span class="fu">sd</span>(fg1)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co"># f2</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>U<span class="ot">&lt;-</span> <span class="fu">runif</span>(m, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U))<span class="sc">*</span>sigma </span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>j<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which</span>(x2<span class="sc">&lt;</span><span class="dv">1</span>)) </span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>x2[j]<span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>fg2<span class="ot">&lt;-</span> x2<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>theta_hat[<span class="dv">2</span>]<span class="ot">&lt;-</span> <span class="fu">mean</span>(fg2)</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">2</span>]<span class="ot">&lt;-</span> <span class="fu">sd</span>(fg2)</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(theta_hat,se)</span></code></pre></div>
<pre><code>##                [,1]      [,2]
## theta_hat 0.3976099 0.3999637
## se        1.1382376 0.3594359</code></pre>
<p>From the result above, we can find that the important function <span class="math inline">\(f_2\)</span> produce the smaller variance.</p>
<p>Because <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> have larger ranges and many of the simulated values will contribute zeros to the sum, which is inefficient. <span class="math inline">\(f_2\)</span> is standard normal distribution, there are large number of zeros produced in the ratio <span class="math inline">\(g(x)/f_2(x)\)</span> in this case, and all other values far from 0, resulting in a large variance.<br />
<br />
</p>
<p>5.14<br />
Use the normal distribution to compute the integration.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>x4<span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m) </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which</span>(x4<span class="sc">&lt;</span><span class="dv">1</span>)) </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>x4[i]<span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span> x4<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>theta_hat<span class="ot">&lt;-</span> <span class="fu">mean</span>(g)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(theta_hat)</span></code></pre></div>
<pre><code>## [1] 0.3976099</code></pre>
<p>Then the estimator value of the integration is about 0.39 (every new running may get different value) by importance sampling.</p>
</div>
<div id="section-3" class="section level2">
<h2>2021-10-14</h2>
<p>6.5<br />
</p>
<p><strong>The flowchart before programming:</strong></p>
<p><em>step1.</em> Generate 20 random variables from <span class="math inline">\(\chi^2(2)\)</span>.</p>
<p><em>step2.</em> Construct <span class="math inline">\(t\)</span> statistic <span class="math inline">\(|\sqrt{n}\frac{mean(\chi^2)-E\chi^2}{sd(\chi^2)}|\)</span>.</p>
<p><em>step3.</em> Compute the confidence interval of the parameter <span class="math inline">\(\mu\)</span> (the expect of <span class="math inline">\(\chi^2(2)\)</span>)</p>
<p><em>step4.</em> Repeat the above procedure and we can obtain <span class="math inline">\(m\)</span> pairs of confidence interval.</p>
<p><em>step5.</em> Approximate the CP by <span class="math inline">\(\frac{1}{m}\sum\limits_{j=1}^{m}I(\hat{\mu}_1\leq\mu\leq\hat{\mu}_2)\)</span></p>
<p><strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>lcl<span class="ot">&lt;-</span> rcl<span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>chi<span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">20</span>,<span class="dv">2</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>lcl[i]<span class="ot">&lt;-</span> <span class="fu">mean</span>(chi)<span class="sc">-</span><span class="fu">sd</span>(chi)<span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>rcl[i]<span class="ot">&lt;-</span> <span class="fu">mean</span>(chi)<span class="sc">+</span><span class="fu">sd</span>(chi)<span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(lcl<span class="sc">&lt;=</span><span class="dv">2</span> <span class="sc">&amp;</span> <span class="dv">2</span><span class="sc">&lt;=</span>rcl)</span></code></pre></div>
<pre><code>## [1] 0.926</code></pre>
<p>Compare with the Example 6.4, the <span class="math inline">\(t\)</span>-interval seems more small and more robust.<br />
<br />
</p>
<p>6.A<br />
<strong>The flowchart before programming:</strong></p>
<p><em>step1.</em> Generate <span class="math inline">\(n\)</span> random variables from <span class="math inline">\(\chi^2(1),~Uniform(0,2),~Exponential(\lambda=1)\)</span>, respectively.</p>
<p><em>step2.</em> Compute statistic <span class="math inline">\(|\sqrt{n}\frac{mean(r.v.)-E(r.v.)}{sd(r.v.)}|\)</span>.</p>
<p><em>step3.</em> Repeat the above procedure and we can obtain <span class="math inline">\(m\)</span> statistics.</p>
<p><em>step4.</em> Calculate the probability <span class="math inline">\(\hat{p}_i\)</span> corresponding to each statistic and compare <span class="math inline">\(2(1-\hat{p}_i)\)</span> with the nominal level <span class="math inline">\(\alpha\)</span></p>
<p><em>step5.</em> Approximate the t1e by <span class="math inline">\(\frac{1}{m}\sum\limits_{j=1}^{m}I(\hat{p}_i\leq\alpha)\)</span><br />
<br />
<strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Chisq</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>C<span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, <span class="at">expr =</span> {x<span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">1</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(n)<span class="sc">*</span>(<span class="fu">mean</span>(x)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">sd</span>(x)})</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>pi1<span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(C),n<span class="dv">-2</span>))</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pi1<span class="sc">&lt;=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.0493</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">##unif</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>U<span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, <span class="at">expr =</span> {y<span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(n)<span class="sc">*</span>(<span class="fu">mean</span>(y)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">sd</span>(y)})</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>pi2<span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(U),n<span class="dv">-2</span>))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pi2<span class="sc">&lt;=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.0523</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">##exp</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>E<span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, <span class="at">expr =</span> {z<span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(n)<span class="sc">*</span>(<span class="fu">mean</span>(z)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">sd</span>(z)})</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>pi3<span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(E),n<span class="dv">-2</span>))</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pi3<span class="sc">&lt;=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.0474</code></pre>
<p>As we can see, the simulation results for the three cases are all about 0.05 i.e., <span class="math inline">\(\alpha\)</span>. The Uniform distribution t1e is a little bigger than others.<br />
<br />
Discussion</p>
<p>We can find that the empirical Type <span class="math inline">\(1\)</span> error rates of the three cases are all close to 0.05.</p>
<p>(1). <span class="math inline">\(H_0: power1-power2=0 \longleftrightarrow H_1: power1-power2\neq 0\)</span>.</p>
<p>(2). We should use the McNemar test. According to the question and the condition, we can infer that the sample of the experiments comes from the same population so that the powers which the two methods are related. We don’t need to know the distribution about the sample.</p>
<p>(3). We need more powers to complete the information. Assume that we use the two methods to repeat experiments and obtain <span class="math inline">\(m\)</span> pairs of powers. Then, we do the minus, and get the difference between the two powers. Using the difference series construct the <span class="math inline">\(t\)</span>-statistic and do the test.</p>
</div>
<div id="section-4" class="section level2">
<h2>2021-10-21</h2>
<p>6.C<br />
<strong>The primary work</strong></p>
<p>The test: <span class="math inline">\(H_0:~\beta_{1,d}=0 \leftrightarrow H_1:~\beta_{1,d}\neq 0\)</span></p>
<p><span class="math display">\[\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]\]</span> Replaced <span class="math inline">\(\beta_{1,d}\)</span> by <span class="math inline">\(b_{1,d}\)</span>:</p>
<p><span class="math display">\[b_{1,d}=\dfrac{1}{n^2}\sum\limits_{i,j=1}^n((X_i-\bar{X})^T\widehat{\Sigma}^{-1}(X_j-X))^3\]</span> <span class="math display">\[\dfrac{nb_{1,d}}{6}\sim \chi^2(\frac{d(d+1)(d+2)}{6})\Rightarrow \left\{ b_{1,d}\geq \dfrac{6}{n}\chi^2(\frac{d(d+1)(d+2)}{6})\right\} is~the~rejection \]</span></p>
</div>
<div id="for-example-6.8" class="section level2">
<h2>For Example 6.8:</h2>
<p><strong>The flowchart before programming:</strong></p>
<p><em>step1.</em> Compute the thresholds <span class="math inline">\(cvs\)</span> corresponding to different <span class="math inline">\(n\)</span></p>
<p><em>step2.</em> Generate <span class="math inline">\(n\)</span> random vectors from <span class="math inline">\(N(0_d,I_d)\)</span>, <span class="math inline">\(d\)</span> is the dimension of random vectors.</p>
<p><em>step3.</em> Standardize the samples (Then we can omit calculating the <span class="math inline">\(\widehat{\Sigma}\)</span>) and use them to calculate <span class="math inline">\(b_{1,d}\)</span>.</p>
<p><em>step4.</em> Compare the every <span class="math inline">\(b_{1,d}\)</span> with <span class="math inline">\(cvs\)</span> and calculate the rate satisfies <span class="math inline">\(b_{1,d}&gt;cvs\)</span>.</p>
<p><em>step5.</em> Repeat the above procedure and we can obtain <span class="math inline">\(m\)</span> rates and the mean of them is the estimator of the t1e.</p>
<p><strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1021</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span> <span class="dv">10000</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span> <span class="dv">5</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>) </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>cvs<span class="ot">&lt;-</span> <span class="dv">6</span><span class="sc">*</span><span class="fu">qchisq</span>(<span class="fl">0.95</span>,d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)<span class="sc">/</span>n </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>p_reject<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n)) <span class="co">#Type-I-error</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>meanX<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,d,<span class="dv">1</span>) </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>sigmaX<span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">rep</span>(<span class="dv">1</span>,d)) </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>b1<span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>Mnsktest<span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>   X<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n[j],meanX,sigmaX)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>   x<span class="ot">&lt;-</span> <span class="fu">scale</span>(X) </span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>   b1[i]<span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(n[j])<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>((x <span class="sc">%*%</span> <span class="fu">t</span>(x))<span class="sc">^</span><span class="dv">3</span>) <span class="co">#skewness test statistic</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>   Mnsktest[i]<span class="ot">&lt;-</span> <span class="fu">as.integer</span>(b1[i] <span class="sc">&gt;=</span> cvs[j])</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>p_reject[j]<span class="ot">&lt;-</span> <span class="fu">mean</span>(Mnsktest)</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>p_reject</span></code></pre></div>
<pre><code>## [1] 0.0099 0.0330 0.0393 0.0495 0.0535 0.0522</code></pre>
<p>The results of the simulation suggest that the Type-I-error is close to 0.05 when the number of sample is large enough. \</p>
</div>
<div id="for-example-6.10" class="section level2">
<h2>For Example 6.10:</h2>
<p><strong>The flowchart before programming:</strong></p>
<p><em>step1.</em> Compute the thresholds <span class="math inline">\(cvs\)</span> corresponding to different <span class="math inline">\(\varepsilon\)</span></p>
<p><em>step2.</em> Generate <span class="math inline">\(n\)</span> random vectors from mixture distribution <span class="math inline">\((1-\varepsilon)N(0_d,I_d)+\varepsilon N(0_d,100I_d)\)</span>, <span class="math inline">\(d\)</span> is the dimension of random vectors.</p>
<p><em>step3.</em> Standardize the the samples (Then we can omit calculating the <span class="math inline">\(\widehat{\Sigma}\)</span>) and use them to calculate and <span class="math inline">\(b_{1,d}\)</span>.</p>
<p><em>step4.</em> Compare the every <span class="math inline">\(b_{1,d}\)</span> with <span class="math inline">\(cvs\)</span> and calculate the rate satisfies <span class="math inline">\(b_{1,d}\geq cvs\)</span>.</p>
<p><em>step5.</em> Repeat the above procedure and we can obtain <span class="math inline">\(m\)</span> rates and the mean of them is the estimator of the power.</p>
<p><em>step6.</em> Give the figure that show the relationship between <span class="math inline">\(\varepsilon\)</span> and power.</p>
<p><strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mixture distribution</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>mix<span class="ot">&lt;-</span> <span class="cf">function</span>(n,e,d,mu,sigma1,sigma10){</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>   X<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,d)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>      s<span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="at">size=</span><span class="dv">1</span>,<span class="at">prob=</span>e)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (s) </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>         X[k,]<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">1</span>,mu,sigma10) <span class="cf">else</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>         X[k,]<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">1</span>,mu,sigma1)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(X)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1021</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>b2<span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>Mnsktest<span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>eps<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.25</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.25</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>l<span class="ot">&lt;-</span> <span class="fu">length</span>(eps)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span> <span class="fu">numeric</span>(l)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>cvs<span class="ot">&lt;-</span> <span class="dv">6</span><span class="sc">*</span><span class="fu">qchisq</span>(<span class="fl">0.9</span>,d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)<span class="sc">/</span>n</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,d)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>sigma1<span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>,d,d)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>sigma10<span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">100</span>,d,d)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>l){</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>   ep<span class="ot">&lt;-</span> eps[k]</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>      X<span class="ot">&lt;-</span> <span class="fu">mix</span>(n,ep,d,mu,sigma1,sigma10) </span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>      x<span class="ot">&lt;-</span> <span class="fu">scale</span>(X)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>   b2[s]<span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>((x <span class="sc">%*%</span> <span class="fu">t</span>(x))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>   Mnsktest[s]<span class="ot">&lt;-</span> <span class="fu">as.integer</span>(b2[s] <span class="sc">&gt;=</span> cvs)</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>   pow[k]<span class="ot">&lt;-</span> <span class="fu">mean</span>(Mnsktest)</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>##  [1] 0.070 0.324 0.499 0.608 0.734 0.792 0.861 0.886 0.918 0.938 0.968 0.967
## [13] 0.976 0.985 0.988 0.989 0.991 0.993 0.991 0.998 1.000 0.997 0.996 0.997
## [25] 0.996 0.993 0.993 0.982 0.967 0.935 0.894 0.812 0.722 0.654 0.538 0.432
## [37] 0.342 0.235 0.184 0.152 0.110 0.078</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;The power is the highest when e is about&quot;</span>,eps[<span class="fu">which.max</span>(pow)])<span class="co">#Find the e corresponding to the maximum power</span></span></code></pre></div>
<pre><code>## [1] &quot;The power is the highest when e is about 0.2&quot;</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(eps,pow,<span class="at">type=</span><span class="st">&#39;b&#39;</span>,<span class="at">xlab=</span><span class="fu">bquote</span>(eps),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">main=</span><span class="st">&quot;Power of demension 5&quot;</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>alpha,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(eps,pow<span class="sc">+</span><span class="fu">sqrt</span>(pow<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pow)<span class="sc">/</span>m),<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(eps,pow<span class="sc">-</span><span class="fu">sqrt</span>(pow<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pow)<span class="sc">/</span>m),<span class="at">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The empirical power figure is shown above. Note that the empirical power always bigger than <span class="math inline">\(\alpha=0.1\)</span> except <span class="math inline">\(\varepsilon=0~or~1\)</span>. Because the mixture is normal when <span class="math inline">\(\varepsilon=0~or~1\)</span>. For <span class="math inline">\(0&lt;\varepsilon&lt;1\)</span> the power of the test is greater than 0.1 and highest when <span class="math inline">\(\varepsilon\)</span> is about 0.2.</p>
</div>
<div id="section-5" class="section level2">
<h2>2021-10-28</h2>
<p>7.7<br />
</p>
<p><strong>The flowchart before programming:</strong></p>
<p><em>step1.</em> Use <span class="math inline">\(sample\)</span> function to select the index and obtain the corresponding set of scor.</p>
<p><em>step2.</em> Compute the <span class="math inline">\(\theta\)</span> of every experiment.</p>
<p><em>step3.</em> Repeat the above procedure and we can obtain <span class="math inline">\(m\)</span> <span class="math inline">\(\hat{\theta}^*\)</span> and use the series to calculate the bias and standard error.</p>
<p><strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1028</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>Sigma_hat<span class="ot">&lt;-</span> <span class="fu">var</span>(scor) </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>lambda_hat<span class="ot">&lt;-</span> <span class="fu">eigen</span>(Sigma_hat) </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>theta_hat<span class="ot">&lt;-</span> <span class="fu">max</span>(lambda_hat<span class="sc">$</span>values)<span class="sc">/</span><span class="fu">sum</span>(lambda_hat<span class="sc">$</span>values) </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>theta_b<span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap steps</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">size=</span>n, <span class="at">replace=</span>T)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  scor_b<span class="ot">&lt;-</span> scor[i,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  Sigma_b<span class="ot">&lt;-</span> <span class="fu">var</span>(scor_b)</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  lambda_b<span class="ot">&lt;-</span> <span class="fu">eigen</span>(Sigma_b)</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  theta_b[b]<span class="ot">&lt;-</span> <span class="fu">max</span>(lambda_b<span class="sc">$</span>values)<span class="sc">/</span><span class="fu">sum</span>(lambda_b<span class="sc">$</span>values)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>bias_b<span class="ot">&lt;-</span> <span class="fu">mean</span>(theta_b)<span class="sc">-</span>theta_hat </span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>se_b<span class="ot">&lt;-</span> <span class="fu">sd</span>(theta_b)</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;the bias of bootstrap =&quot;</span>, bias_b, <span class="st">&quot;the standard error of bootstrap =&quot;</span>, se_b)</span></code></pre></div>
<pre><code>## the bias of bootstrap = 0.002012506 the standard error of bootstrap = 0.04717674</code></pre>
<p>\</p>
</div>
<div id="answers" class="section level2">
<h2>Answers</h2>
<p>7.8<br />
</p>
<p><strong>The flowchart before programming:</strong></p>
<p><em>step1.</em> Delete the <span class="math inline">\(i\)</span> th sample and use the remaining to compute <span class="math inline">\(\hat{\theta}^*\)</span>.</p>
<p><em>step2.</em> Repeat the above procedure and we can obtain <span class="math inline">\(m\)</span> <span class="math inline">\(\hat{\theta}^*\)</span> and use the series to calculate the bias and standard error.</p>
<p><strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1028</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>theta_j<span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  Sigma_j<span class="ot">&lt;-</span> <span class="fu">var</span>(scor[<span class="sc">-</span>i,])</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  lambda_j<span class="ot">&lt;-</span> <span class="fu">eigen</span>(Sigma_j)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  theta_j[i]<span class="ot">&lt;-</span> <span class="fu">max</span>(lambda_j<span class="sc">$</span>values)<span class="sc">/</span><span class="fu">sum</span>(lambda_j<span class="sc">$</span>values)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>bias_j<span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta_j)<span class="sc">-</span>theta_hat) </span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>se_j<span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta_j<span class="sc">-</span><span class="fu">mean</span>(theta_j))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;the bias of jackknife =&quot;</span>, bias_j, <span class="st">&quot;the standard error of jackknife =&quot;</span>, se_j)</span></code></pre></div>
<pre><code>## the bias of jackknife = 0.001069139 the standard error of jackknife = 0.04955231</code></pre>
</div>
<div id="answers-1" class="section level2">
<h2>Answers</h2>
<p>7.9<br />
</p>
<p><strong>The flowchart before programming:</strong></p>
<p><em>step1.</em> Write a function to calculate <span class="math inline">\(\hat{\theta}^*\)</span>.</p>
<p><em>step2.</em> Use <span class="math inline">\(boot\)</span> and <span class="math inline">\(boot.ci\)</span> to bootstrap and compute the confidence interval for different method.</p>
<p><strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1028</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;boot&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>eta.interval<span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#i&lt;-sample(n,replace=T)</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  lambda.star<span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cor</span>(x[i,]))</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  theta.star<span class="ot">&lt;-</span> <span class="fu">max</span>(lambda.star<span class="sc">$</span>values)<span class="sc">/</span><span class="fu">sum</span>(lambda.star<span class="sc">$</span>values)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span> <span class="fu">ncol</span>(scor)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>sta<span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>scor,<span class="at">statistic=</span>eta.interval,<span class="at">R=</span><span class="dv">999</span>)</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>ci<span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(sta,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 999 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = sta, type = c(&quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level     Percentile            BCa          
## 95%   ( 0.5492,  0.7145 )   ( 0.5535,  0.7160 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
<div id="answers-2" class="section level2">
<h2>Answers</h2>
<p>7.C<br />
</p>
<p><strong>The flowchart before programming:</strong></p>
<p><em>step1.</em> Write a function to calculate the skewness.</p>
<p><em>step2.</em> Generate <span class="math inline">\(n\)</span> random variables from normal and <span class="math inline">\(\chi^2(5)\)</span> distributions, respectively.</p>
<p><em>step3.</em> Compute the sample skewness and use <span class="math inline">\(boot\)</span> to repeat and obtain the one series of skewness.</p>
<p><em>step4.</em> Use the sample skewness to estimate the confidence interval for different method.</p>
<p><em>step5.</em> Repeat the above procedure and we can obtain <span class="math inline">\(m\)</span> confidence intervals and the mean of them is the estimator of coverage rates. The confidence intervals miss on the left or right also can be calculate by sum.</p>
<p><strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1028</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fBasics)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;fBasics&#39;是用R版本4.1.2 来建造的</code></pre>
<pre><code>## 载入需要的程辑包：timeDate</code></pre>
<pre><code>## 
## 载入程辑包：&#39;timeDate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:xtable&#39;:
## 
##     align</code></pre>
<pre><code>## 载入需要的程辑包：timeSeries</code></pre>
<pre><code>## Warning: 程辑包&#39;timeSeries&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>ske.interval<span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">skewness</span>(x[i])</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>ci1.n<span class="ot">&lt;-</span>ci1.p<span class="ot">&lt;-</span> ci1.b<span class="ot">&lt;-</span>ci2.n<span class="ot">&lt;-</span>ci2.p<span class="ot">&lt;-</span> ci2.b<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>x.norm<span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>sta.norm<span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x.norm,<span class="at">statistic=</span>ske.interval,<span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(sta.norm,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;basic&quot;</span>))</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>ci1.n[k,]<span class="ot">&lt;-</span> ci.norm<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>ci1.p[k,]<span class="ot">&lt;-</span> ci.norm<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>ci1.b[k,]<span class="ot">&lt;-</span> ci.norm<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>cp1.n<span class="ot">&lt;-</span> <span class="fu">mean</span>(ci1.n[,<span class="dv">1</span>]<span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> ci1.n[,<span class="dv">2</span>]<span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>cp1.p<span class="ot">&lt;-</span> <span class="fu">mean</span>(ci1.p[,<span class="dv">1</span>]<span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> ci1.p[,<span class="dv">2</span>]<span class="sc">&gt;=</span> <span class="dv">0</span>) </span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>cp1.b<span class="ot">&lt;-</span> <span class="fu">mean</span>(ci1.b[,<span class="dv">1</span>]<span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> ci1.b[,<span class="dv">2</span>]<span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>misl1.n<span class="ot">&lt;-</span> <span class="fu">sum</span>(ci1.n[,<span class="dv">1</span>]<span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>misr1.n<span class="ot">&lt;-</span> <span class="fu">sum</span>(ci1.n[,<span class="dv">2</span>]<span class="sc">&lt;=</span> <span class="dv">0</span>)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>misl1.p<span class="ot">&lt;-</span> <span class="fu">sum</span>(ci1.p[,<span class="dv">1</span>]<span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>misr1.p<span class="ot">&lt;-</span> <span class="fu">sum</span>(ci1.p[,<span class="dv">2</span>]<span class="sc">&lt;=</span> <span class="dv">0</span>)</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>misl1.b<span class="ot">&lt;-</span> <span class="fu">sum</span>(ci1.b[,<span class="dv">1</span>]<span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>misr1.b<span class="ot">&lt;-</span> <span class="fu">sum</span>(ci1.b[,<span class="dv">2</span>]<span class="sc">&lt;=</span> <span class="dv">0</span>)</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;norm=&quot;</span>,cp1.n,<span class="st">&quot;percentile=&quot;</span>,cp1.p,<span class="st">&quot;basic=&quot;</span>,cp1.b)</span></code></pre></div>
<pre><code>## norm= 0.932 percentile= 0.954 basic= 0.926</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;miss on the left=&quot;</span>,<span class="fu">cbind</span>(misl1.n,misl1.p,misl1.b))</span></code></pre></div>
<pre><code>## miss on the left= 33 24 33</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;miss on the right=&quot;</span>,<span class="fu">cbind</span>(misr1.n,misr1.p,misr1.b))</span></code></pre></div>
<pre><code>## miss on the right= 35 22 41</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>ske.chisq<span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">8</span><span class="sc">/</span><span class="dv">5</span>) </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>x.chisq<span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">5</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>sta.chisq<span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x.chisq,<span class="at">statistic=</span>ske.interval,<span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>ci.chisq<span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(sta.chisq,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;basic&quot;</span>))</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>ci2.n[k,]<span class="ot">&lt;-</span> ci.chisq<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>ci2.p[k,]<span class="ot">&lt;-</span> ci.chisq<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>ci2.b[k,]<span class="ot">&lt;-</span> ci.chisq<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>cp2.n<span class="ot">&lt;-</span> <span class="fu">mean</span>(ci2.n[,<span class="dv">1</span>]<span class="sc">&lt;=</span> ske.chisq <span class="sc">&amp;</span> ci2.n[,<span class="dv">2</span>]<span class="sc">&gt;=</span> ske.chisq)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>cp2.p<span class="ot">&lt;-</span> <span class="fu">mean</span>(ci2.p[,<span class="dv">1</span>]<span class="sc">&lt;=</span> ske.chisq <span class="sc">&amp;</span> ci2.p[,<span class="dv">2</span>]<span class="sc">&gt;=</span> ske.chisq) </span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>cp2.b<span class="ot">&lt;-</span> <span class="fu">mean</span>(ci2.b[,<span class="dv">1</span>]<span class="sc">&lt;=</span> ske.chisq <span class="sc">&amp;</span> ci2.b[,<span class="dv">2</span>]<span class="sc">&gt;=</span> ske.chisq)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>misl2.n<span class="ot">&lt;-</span> <span class="fu">sum</span>(ci2.n[,<span class="dv">1</span>]<span class="sc">&gt;=</span> ske.chisq)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>misr2.n<span class="ot">&lt;-</span> <span class="fu">sum</span>(ci2.n[,<span class="dv">2</span>]<span class="sc">&lt;=</span> ske.chisq)</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>misl2.p<span class="ot">&lt;-</span> <span class="fu">sum</span>(ci2.p[,<span class="dv">1</span>]<span class="sc">&gt;=</span> ske.chisq)</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>misr2.p<span class="ot">&lt;-</span> <span class="fu">sum</span>(ci2.p[,<span class="dv">2</span>]<span class="sc">&lt;=</span> ske.chisq)</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>misl2.b<span class="ot">&lt;-</span> <span class="fu">sum</span>(ci2.b[,<span class="dv">1</span>]<span class="sc">&gt;=</span> ske.chisq)</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>misr2.b<span class="ot">&lt;-</span> <span class="fu">sum</span>(ci2.b[,<span class="dv">2</span>]<span class="sc">&lt;=</span> ske.chisq)</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;norm=&quot;</span>,cp2.n,<span class="st">&quot;percentile=&quot;</span>,cp2.p,<span class="st">&quot;basic=&quot;</span>,cp2.b)</span></code></pre></div>
<pre><code>## norm= 0.741 percentile= 0.727 basic= 0.694</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;miss on the left=&quot;</span>,<span class="fu">cbind</span>(misl2.n,misl2.p,misl2.b))</span></code></pre></div>
<pre><code>## miss on the left= 32 0 61</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;miss on the right=&quot;</span>,<span class="fu">cbind</span>(misr2.n,misr2.p,misr2.b))</span></code></pre></div>
<pre><code>## miss on the right= 227 273 245</code></pre>
<p>As we can see, for normal populations, the percentile confidence interval of skewness obtains the best coverage rate, i.e.,0.954, close to <span class="math inline">\(1-\alpha=0.95\)</span>, for <span class="math inline">\(\chi^2(5)\)</span> distributions, the three confidence interval all seems bad. Compare the two kinds of coverage rates, we can conclude that for normal populations is better.</p>
</div>
<div id="section-6" class="section level2">
<h2>2021-11-04</h2>
<p>8.2<br />
</p>
<p><strong>The flowchart before programming:</strong></p>
<p><em>step1.</em> Choose a data set as the sample and use <span class="math inline">\(cor.test\)</span> to test the original data.</p>
<p><em>step2.</em> Randomly permutate the original data series to calculate the spearman rank correlation.</p>
<p><em>step3.</em> Repeat the above procedure and we can obtain <span class="math inline">\(B\)</span> statistics and use the series to calculate the <span class="math inline">\(p\)</span>-value.</p>
<p><strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1109</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>spcor<span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">c</span>(X,Y)</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span> <span class="fu">length</span>(Z)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>spcor0<span class="ot">&lt;-</span> <span class="fu">cor</span>(X,Y,<span class="at">method=</span><span class="st">&#39;spearman&#39;</span>) <span class="co"># spearman</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>p0<span class="ot">&lt;-</span><span class="fu">cor.test</span>(X,Y) </span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Shuffle the original sample order</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N,<span class="at">size=</span>n,<span class="at">replace=</span>F)</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>  Xp<span class="ot">&lt;-</span> Z[i];Yp<span class="ot">&lt;-</span>Z[<span class="sc">-</span>i]</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>  spcor[b]<span class="ot">&lt;-</span> <span class="fu">cor</span>(Xp,Yp,<span class="at">method=</span><span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(spcor0,spcor))<span class="sc">&gt;=</span>spcor0) </span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(p0<span class="sc">$</span>p.value,p),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.964 0.935</code></pre>
<p>The significance level of the permutation test is about 0.935, and the <span class="math inline">\(p\)</span>-value reported by <span class="math inline">\(cor.test\)</span> on the same sample is 0.964. The permutation test <span class="math inline">\(p\)</span>-value is close to another.</p>
<ol start="2" style="list-style-type: decimal">
<li><br />
</li>
</ol>
<p><strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NN test function</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>Tm <span class="ot">&lt;-</span> <span class="cf">function</span>(h,i,N,k) {</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> N[<span class="dv">1</span>]; q <span class="ot">&lt;-</span> N[<span class="dv">2</span>]; l <span class="ot">&lt;-</span> p <span class="sc">+</span> q</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(h)) h <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(h,<span class="dv">0</span>);</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> h[i, ];</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  nn <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>h, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  qj1 <span class="ot">&lt;-</span> nn<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>p,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  qj2 <span class="ot">&lt;-</span> nn<span class="sc">$</span>nn.idx[(p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>l,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>  c1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(qj1 <span class="sc">&lt;</span> p <span class="sc">+</span> .<span class="dv">5</span>); c2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(qj2 <span class="sc">&gt;</span> p<span class="fl">+.5</span>)</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>  (c1 <span class="sc">+</span> c2) <span class="sc">/</span> (k <span class="sc">*</span> l)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(h,N,k){</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>h,<span class="at">statistic=</span>Tm,<span class="at">R=</span>R, <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">N =</span> N,<span class="at">k=</span>k)</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(tt<span class="sc">&gt;=</span>tt[<span class="dv">1</span>])</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>tt[<span class="dv">1</span>],<span class="at">p.value=</span>p.value)</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;RANN&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;energy&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Ball&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>p.values<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,B,<span class="dv">3</span>)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span>n<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">30</span>)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)</span></code></pre></div>
<p><br />
</p>
<p><strong>(1) Unequal variance and equal expectations</strong></p>
<p><span class="math display">\[x_1\sim N(\left(\matrix{0\\
0}\right),\left(\matrix{1&amp;0\\
0&amp;1}\right)),~y_1\sim N(\left(\matrix{0\\
0}\right),\left(\matrix{2&amp;0\\
0&amp;8}\right))\]</span> <span class="math display">\[n(x_1)=20,~n(y_1)=30\]</span></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1104</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(mu[<span class="dv">1</span>],<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>sigma11 <span class="ot">&lt;-</span> <span class="fu">diag</span>(sigma[<span class="dv">1</span>],<span class="dv">2</span>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>sigma12 <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">2</span><span class="sc">*</span>sigma,<span class="dv">2</span>)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n[<span class="dv">1</span>],mu1,sigma11)</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>y1<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n[<span class="dv">2</span>],mu1,sigma12)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>z1<span class="ot">&lt;-</span> <span class="fu">rbind</span>(x1,y1)</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>p.values[b,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z1,N,k)<span class="sc">$</span>p.value</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>p.values[b,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z1,N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>p.values[b,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x1,<span class="at">y=</span>y1,<span class="at">num.permutations =</span> R,<span class="at">seed=</span>b<span class="sc">*</span><span class="dv">1104</span>)<span class="sc">$</span>p.value</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;NN power=&#39;</span>,pow[<span class="dv">1</span>],<span class="st">&#39;Energy power=&#39;</span>,pow[<span class="dv">2</span>],<span class="st">&#39;Ball power=&#39;</span>,pow[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>## NN power= 0.61 Energy power= 0.63 Ball power= 0.99</code></pre>
<p>Ball test more powerful than NN test and Energy test.<br />
</p>
<p><strong>(2) Unequal variance and equal expectations</strong></p>
<p><span class="math display">\[x_2\sim N(\left(\matrix{0\\
0}\right),\left(\matrix{1&amp;0\\
0&amp;4}\right)),~y_2\sim N(\left(\matrix{0\\
1}\right),\left(\matrix{2&amp;0\\
0&amp;8}\right))\]</span> <span class="math display">\[n(x_2)=20,~n(y_2)=30\]</span></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (2)</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1104</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>mu21<span class="ot">&lt;-</span> <span class="fu">matrix</span>(mu[<span class="dv">1</span>],<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>mu22<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">2</span><span class="sc">*</span>mu,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>sigma21<span class="ot">&lt;-</span> <span class="fu">diag</span>(sigma,<span class="dv">2</span>)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>sigma22<span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">2</span><span class="sc">*</span>sigma,<span class="dv">2</span>)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n[<span class="dv">1</span>],mu21,sigma21)</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>y2<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n[<span class="dv">2</span>],mu22,sigma22)</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>z2<span class="ot">&lt;-</span> <span class="fu">rbind</span>(x2,y2)</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>p.values[b,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z2,N,k)<span class="sc">$</span>p.value</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>p.values[b,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z2,N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>p.values[b,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x2,<span class="at">y=</span>y2,<span class="at">num.permutations =</span> R,<span class="at">seed=</span>b<span class="sc">*</span><span class="dv">1104</span>)<span class="sc">$</span>p.value</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;NN power=&#39;</span>,pow[<span class="dv">1</span>],<span class="st">&#39;Energy power=&#39;</span>,pow[<span class="dv">2</span>],<span class="st">&#39;Ball power=&#39;</span>,pow[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>## NN power= 0.43 Energy power= 0.81 Ball power= 0.84</code></pre>
<p>The performance of Ball and Energy test is better than NN test, and Energy power is the highest.<br />
</p>
<p><strong>(3) Non-normal distributions: </strong></p>
<p><strong>(i) t distributions with 1 df </strong></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1104</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>x31<span class="ot">&lt;-</span> <span class="fu">rt</span>(n[<span class="dv">1</span>],<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>y31<span class="ot">&lt;-</span> <span class="fu">rt</span>(n[<span class="dv">2</span>],<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>z31<span class="ot">&lt;-</span> <span class="fu">c</span>(x31,y31)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>p.values[b,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z31,N,k)<span class="sc">$</span>p.value</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>p.values[b,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z31,N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>p.values[b,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x31,<span class="at">y=</span>y31,<span class="at">num.permutations =</span> R,<span class="at">seed=</span>b<span class="sc">*</span><span class="dv">1104</span>)<span class="sc">$</span>p.value</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;NN power=&#39;</span>,pow[<span class="dv">1</span>],<span class="st">&#39;Energy power=&#39;</span>,pow[<span class="dv">2</span>],<span class="st">&#39;Ball power=&#39;</span>,pow[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>## NN power= 0.5 Energy power= 0.44 Ball power= 0.6</code></pre>
<p><br />
<strong>(ii) bimodel distribution(mixture of two normal distributions)</strong></p>
<p><span class="math display">\[x_{32}\sim \varepsilon_1N(\left(\matrix{0\\
0}\right),\left(\matrix{1&amp;0\\
0&amp;1}\right))+(1-\varepsilon_1)N(\left(\matrix{1\\
1}\right),\left(\matrix{4&amp;0\\
0&amp;4}\right)),\]</span></p>
<p><span class="math display">\[y_{32}\sim \varepsilon_2N(\left(\matrix{0\\
0}\right),\left(\matrix{1&amp;0\\
0&amp;1}\right))+(1-\varepsilon_2)N(\left(\matrix{1\\
1}\right),\left(\matrix{4&amp;0\\
0&amp;4}\right)),\]</span></p>
<p><span class="math display">\[n(x_{32})=20,~n(y_{32})=30\]</span></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1104</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>e1<span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>e2<span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,n[<span class="dv">1</span>],<span class="at">prob=</span><span class="fu">c</span>(e1,<span class="dv">1</span><span class="sc">-</span>e1),<span class="at">replace=</span>T)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>n2<span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,n[<span class="dv">2</span>],<span class="at">prob=</span><span class="fu">c</span>(e2,<span class="dv">1</span><span class="sc">-</span>e2),<span class="at">replace=</span>T)</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>x32<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n[<span class="dv">1</span>],<span class="fu">matrix</span>(mu[<span class="dv">1</span>],<span class="dv">2</span>,<span class="dv">1</span>),<span class="fu">diag</span>(sigma[<span class="dv">1</span>],<span class="dv">2</span>))</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>y32<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n[<span class="dv">2</span>],<span class="fu">matrix</span>(mu[<span class="dv">2</span>],<span class="dv">2</span>,<span class="dv">1</span>),<span class="fu">diag</span>(sigma,<span class="dv">2</span>))</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>z32<span class="ot">&lt;-</span> <span class="fu">rbind</span>(x32,y32)</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>p.values[b,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z32,N,k)<span class="sc">$</span>p.value</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>p.values[b,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z32,N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>p.values[b,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x32,<span class="at">y=</span>y32,<span class="at">num.permutations =</span> R,<span class="at">seed=</span>b<span class="sc">*</span><span class="dv">1104</span>)<span class="sc">$</span>p.value</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;NN power=&#39;</span>,pow[<span class="dv">1</span>],<span class="st">&#39;Energy power=&#39;</span>,pow[<span class="dv">2</span>],<span class="st">&#39;Ball power=&#39;</span>,pow[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>## NN power= 0.85 Energy power= 0.97 Ball power= 0.97</code></pre>
<p>The Ball power is the highest so Ball test is the best.<br />
</p>
<p><strong>(4) Unbalanced samples</strong> <span class="math display">\[x_4\sim N(\left(\matrix{0\\
0}\right),\left(\matrix{1&amp;0\\
0&amp;1}\right)),~y_4\sim N(\left(\matrix{0\\
1}\right),\left(\matrix{4&amp;0\\
0&amp;4}\right))\]</span></p>
<p><span class="math display">\[n(x_4)=5,~n(y_4)=45\]</span></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1104</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>m2<span class="ot">&lt;-</span> <span class="dv">45</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>N4<span class="ot">&lt;-</span> <span class="fu">c</span>(m1,m2)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>x4<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(m1,<span class="fu">matrix</span>(mu[<span class="dv">1</span>],<span class="dv">2</span>,<span class="dv">1</span>),<span class="fu">diag</span>(sigma[<span class="dv">1</span>],<span class="dv">2</span>))</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>y4<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(m2,<span class="fu">matrix</span>(mu[<span class="dv">2</span>],<span class="dv">2</span>,<span class="dv">1</span>),<span class="fu">diag</span>(sigma[<span class="dv">2</span>],<span class="dv">2</span>))</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>z4<span class="ot">&lt;-</span> <span class="fu">rbind</span>(x4,y4)</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>p.values[b,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z4,N4,k)<span class="sc">$</span>p.value</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>p.values[b,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z4,N4,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>p.values[b,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x4,<span class="at">y=</span>y4,<span class="at">num.permutations =</span> R,<span class="at">seed=</span>b<span class="sc">*</span><span class="dv">1104</span>)<span class="sc">$</span>p.value</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;NN power=&#39;</span>,pow[<span class="dv">1</span>],<span class="st">&#39;Energy power=&#39;</span>,pow[<span class="dv">2</span>],<span class="st">&#39;Ball power=&#39;</span>,pow[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>## NN power= 0.16 Energy power= 0.21 Ball power= 0.72</code></pre>
<p>The NN power is the lowest and Ball test still has the highest power.</p>
</div>
<div id="section-7" class="section level2">
<h2>2021-11-11</h2>
<p>9.3<br />
</p>
<p><strong>The flowchart before programming:</strong></p>
<p><em>step1.</em> Choose the normal distribution as the proposal distribution.</p>
<p><em>step2.</em> Initialize constants and parameters. Use the M-H algorithm to obtain a sample of the Cauchy distribution .</p>
<p><em>step3.</em> Repeat the above procedure and we can obtain a chain.</p>
<p><strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">1111</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    cauchy <span class="ot">&lt;-</span> <span class="cf">function</span>(x,theta,eta) {</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span>(theta<span class="sc">*</span>pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>((x<span class="sc">-</span>eta)<span class="sc">/</span>theta)<span class="sc">^</span><span class="dv">2</span>))) <span class="co"># cauchy distribution pdf</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    rep <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    theta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>    eta<span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>    sigma<span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(rep)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(rep)</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>rep) {</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>        xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>        y<span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,xt,sigma) <span class="co"># normal distribution as proposal distribution</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>        num <span class="ot">&lt;-</span> <span class="fu">cauchy</span>(y,theta,eta)</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>        den <span class="ot">&lt;-</span> <span class="fu">cauchy</span>(xt,theta,eta)</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den){</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>          x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a>          x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>          k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span>     <span class="co"># reject y, repeat steps above</span></span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a>    index <span class="ot">&lt;-</span> <span class="dv">9500</span><span class="sc">:</span><span class="dv">10000</span></span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a>    y1 <span class="ot">&lt;-</span> x[index]</span>
<span id="cb101-29"><a href="#cb101-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(index, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">main=</span><span class="st">&quot;Part of a chain generated by M-H sampler of a Cauchy distribution&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;x&quot;</span>) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>    M<span class="ot">&lt;-</span> <span class="dv">5</span> </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    burn <span class="ot">&lt;-</span> <span class="dv">1001</span>      </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> x[burn<span class="sc">:</span>rep]</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    QT <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">9</span><span class="sc">/</span><span class="dv">10</span>)  </span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    QC <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y, (<span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">/</span><span class="dv">10</span>) </span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>    QT[<span class="dv">1</span>]<span class="ot">&lt;-</span>QC[<span class="dv">1</span>]<span class="ot">&lt;-</span> <span class="sc">-</span>M</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>    QT[<span class="dv">10</span>]<span class="ot">&lt;-</span>QC[<span class="dv">10</span>]<span class="ot">&lt;-</span> M</span></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">qqplot</span>(QC, QT,<span class="at">main=</span><span class="st">&quot;QQ plot for a M-H chain&quot;</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="st">&#39;blue&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(y, <span class="at">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="at">main=</span><span class="st">&quot;Histogram with target Cauchy density&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.35</span>), <span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>    z<span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(y),<span class="fu">max</span>(y),<span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(z, <span class="fu">cauchy</span>(z,theta,eta),<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAyVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQOjqQZgCQZjqQkGaQkLaQtpCQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa227a229u22/+2/9u2///T09PbkDrbkGbbtmbbtpDb27bb29vb2//b////AAD/tmb/25D/27b//7b//9v///+GDXjoAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALtElEQVR4nO2de3/bthWGodTp5M5N6lRKusZeuy7rzPQSN2KbrhZti9//Qw13ghTJlxQIApLP+4etnwSeAz48uJMgK0m9YrEzkLoIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgTE2LLcXbPnd7Vvdz99nNyT9iJN52xx0/h1pEc3/e6PC8bYi9thR+773lPGnlnrrYAe3jwLBUiZ3svkWI9u+sc3TGk16NADAPUmmFjK9F4mx3p00nPwRldDDj08gn7ngbq4vBW/c4kkn75h7LN/yODavWfs7EYeyT38+w17dlt+EpfuBff2uGbLTxds8bb8/Zynsm6E1Uzmu2DsrfCiTXMT/5UGbVLl0VqsnDiO5efFqzsnhzIlO3vHY4pzEv4qE+oYnjcZWaIYfvZWWda++XnL6CgqtLv3/ATeud4qQLm6Cvwn415/I2sOeZkWF9XXz+8K9TO/HjwTShdOxrlf/dNKZva3GiDrzAVUWbROXMfazdlHFxBPoD/889Vf8mSNiRqgzJZCx3euDq0CxkZj5c0CElFwV/5hTocfcX+uua2k3+XdLjPcnt+W/+NH/e1OJFppCvxY9lanF+I/XYk/ysNSXQZTxISJKqn62rFonNQcZyKi1M/VOYl8V4XDNeEC4ma+vntYV9mXvmUOXQvK2/uaNwOIfzz7UCuDmcPXOlMeTET++cuFMMC/5+eu/qrM6cwu5fV69lHkpAHoqop+9yJqi9aJ41gnz6v86MvQqJyNCReQdnv5oeZblTGnhLV5M4BUdKkax1xP2baJSs18NnWQrDt235sQVNdA/XUynMsy9fl6cSNOqg5ocVO7dLrUW4vGietYXE1TfjoBOSYcQG477frWsM1vplKqebN10INqLRf/0aZN9gVg89kFJIie/fDnuhsQr4R+XIvKeZWpKwAAORaNE9dxwdoA7RUxa8JWFCt75k1AIrKdOG715vSDHv51ISvGYRGkSDz2AOJffHUuwufz6ir2AXIsdkSQbcdr9aqppC9vaybqgFojSIBzmv02b42O4u67qoR310HSoiq6ppJuAySbDtXaLW4GAHIs2nJcrxWWpZvenLDTzO+bKJxmp3jxruE7Fw1k1Utu8WYByXpelDPZcgkb3a2YiaDndyJbnREk21z5qzBkOhOqEW8Akl84Fi2geivGe1oP68qMLVVaVw0TPCfis8r/K1nNXtV9y5qmqsPavNkIel/1IArTTZDa7wfZOqi/kpbur2TCpYlfZXoPkPz6t8pi1RLs94OcHKqSbIYar2qZKm016/SDlo2LI9K7fXidrK0fpPqaasgne6+3uif9rbpO/KuXt3ut2Nm73IbjPiBuWHf6rgwgZXoPkPq6sliFiOO4fPien/Olm0OVROX8Qz1TPCuc3OWvbk/627IZvUV9rLX7+Zz3t11v46Y7Mqe8zqpgjgs0ghsIKJMBzKOjZWgbVIEd8zoXjJIHAjK9AjgQnlpBHctqBkySDC1iD9+c67H+zArpmANafA3S0JQrEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBDQNIHuf6enxHndG5ibSztvWnjig3NyvVnTduPa0Ae2uLZa846bTpw3ocW3vmC06CtnTBkQRhJSbm66pDuqQeX6h87b3pw5obnMJiAABHXBGRc+DATMC4iV9uw3fdx/7tA9b3b+8cxt8H3NeYpvNlm03SQHKxDOVMnoSaOYTBCTj5v4L+cBq/I4i22zTAyR6P7u/ykQiiNNJC1CZVw+r1zuKMaY7UgRU5uZR5K7HGOcGxKuh0G6SNtfrigABV0kDyhNoxbabhAHNZK7XFQECrggQcJUioJRWNRSgzTa0mzGJk1rVSBBQWnPScwOqb3XVqrRWNeaPoBxtZJFWBHE+8xcxwCipVY0ogEq972FX6pRWNWIAEnvRiC21Rm9mFGO6Y3ZAei+2srsGHmUuuDQgFpiQ04pNsYfRKQN6rfh4hE/5JAB1TWSMNBde8wLKqmp22Mbn/eZm0JZFiqCJzAUWY7MDStJct58NAer34wAK2/tSth/XK7t16VFU0i6gTdC1seOPoE3YxUMChDzZT2I5Oe8Zh440F1YxAGXizQjLMvPaVfaEAYnpQrHmfhxDDXHXQgRAmdjpum82SPSyi5aWbvbpjgiAeNl6XIsXtHQXMQlITrZGvwUvBiCxd/DN7rqnChKANJrYc9IxAGEJQPfnElDsVQ0XUNjV1bGAEoyguQDBZWU9Zb8s92/BazEXVjEAZUPad1lRda/6nDKgzqA4zFxgRQE06A2BQ80Fllp2nhVQbwM/3lxgRQDUc2/vQebCKgKgARNmNkl3qiiAgq6ujjqj3TVq6Z44IFxRnTQg+ZbLrL+x76io5h7Nb1kEQMXiJhej+WNYOIwBSNw+JkZY6S89M7VqODcg0VEUgNKfUZQNew1QyMXDvQjKBs3ax3xWIxIgXQflft3FUwak+oGed1HNA2i7Byhc83mEC4fqQbE6oHCzrkf4rEYboHDDscZYrL+GTuNZjRZAAcerxnCmKue87wazRO60jwKoMJWzXrVoVSLPauiHNGYF5AxCe9bmU4mgCICcEVjfUCONZzXaAIUbbRhAsPDodLGf1RDeEwbUaWW26Q7B4ggBNcwFlGCxIUA9DjoABRuOGUBwOn6MuYCKBChVcy0OnHvvCFCbg05AgQidDKCSAKnOxLYDUKg5oaMCpKd+WgFtAk15HBugbSegQOOxowPUQoYAGeP9gML0po8MUHO2vg4oBKFTAhSks3hcgPbnWoPP3U+zqjHPdAfbAkAh6ulRFiOvarTOlIWe9RhzRlHnpNVMIgQ0+SO+4x5FiLiq0TkIa45ZJ15kPZ4I6hqEBR5xjKyD4qxqyDEqImM71NPWQ+POKNKqRsv9HLP1F9PvB8nwQe177d+kk2cJAzJdK4FnGBmnMZsMUcK3v+g6t2eCo/ufxDpNLsYknrejWNEZD0gNPKaAlGgzv1U6jIz+V9nxyUkCHcVqIMe2VsyDjKmrTZ+6snpI7kaknTSCtq1qnKUXIMXIHUEfwmiajmJjNO+GQqdYLAUEhDuKp6e5nl86WhEgoAMB+T0TdEwKs5aUknzPZRIi442mlCTo8YcaTSnJhMfjDVCGGk0pyXTH48HqYKMpJZns+AFDjcFGU0oy2fGD74VN6ewpgvyTTHc8XtUYbDSlJBMeP3CwmtLZJ9kPOiURICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQ0PSA7v8u5tKqzbkPFbRQwP2y/DMRANDjWk423n/h+7oyZEFsWFP0E/LPxPSA+GWVgPz2JyixBTW92f8eGf9MTA6oYCuVq9x7d2pgQW101L8E7p+JEHWQApR9yTxflwgsqOLTHyP+mQgGSLzkhWfQI3PIgqp+eish/0yU4SKo+dHfWPMXDGiSTAQF1Lch2jB1WxhSxKbIxGSA7JvYXUCHNbPOS927LQyppH0yYRQoglT2faIbWRjQzPtnogzYiomce9WPyMKAjqJ/JgLWQeLlyH41ELKQ4615/TNBg1UkAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQKkDkrf4THE776FKHZC422h37Xuro4dSByQ2VJniiYKDlTogUcb6d1IJrOQB8TLmeZehn5IH9Pj6x9cRS1j6gHbXX0bdGDV5QP1veA+v9AFFbcOOAtDLqFsPpw8oj1rCkgd0fx557+rUAUUXAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAf0fe4zZ9bkPR8oAAAAASUVORK5CYII=" /><!-- --></p>
<p>9.8.<br />
By the conditions from the question:</p>
<p><span class="math display">\[X|_{Y=y}\sim Binomial(n,y),~Y|_{X=x}\sim Beta(x+a,n-x+b)\]</span> <strong>The flowchart before programming:</strong></p>
<p><em>step1.</em> Initialize. Assuming that <span class="math inline">\(X_0=1,~Y_0=0.5\)</span>.</p>
<p><em>step2.</em> Generate <span class="math inline">\(X_1\)</span> from <span class="math inline">\(Binomial(n,0.5)\)</span> and <span class="math inline">\(Y_1\)</span> from <span class="math inline">\(Beta(X_1+a,n-X_1+b)\)</span></p>
<p><em>step3.</em> Repeat the above procedure and we can obtain a chain of <span class="math inline">\((x,y)\)</span>.<br />
</p>
<p><strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>chain<span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>burn<span class="ot">&lt;-</span> <span class="dv">4000</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, chain, <span class="dv">2</span>) </span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>Z[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># initial </span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>Z[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>chain) {</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> Z[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>Z[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,Y)</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span> Z[i, <span class="dv">1</span>]</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>Z[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X<span class="sc">+</span>a,n<span class="sc">-</span>X<span class="sc">+</span>b)</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> Z[b<span class="sc">:</span>chain, ]</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z[,<span class="dv">1</span>],<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Random numbers&#39;</span>)</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(z[,<span class="dv">2</span>],<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;bottomright&#39;</span>,<span class="fu">c</span>(<span class="fu">expression</span>(x),<span class="fu">expression</span>(y)),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>        <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for chain in i-th row of X</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>        psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>        k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>        psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>        psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>        W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>        v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>        r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(r.hat)</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<p><br />
</p>
<p><strong>For 9.3</strong></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>cauchy <span class="ot">&lt;-</span> <span class="cf">function</span>(x,theta,eta) {</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span>(theta<span class="sc">*</span>pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>((x<span class="sc">-</span>eta)<span class="sc">/</span>theta)<span class="sc">^</span><span class="dv">2</span>))) </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>cauchy.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, eta, chain, sigma, X1) {</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">#generates a Metropolis chain for Cauchy(1,0)</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">#with Normal(X[t], sigma) proposal distribution</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">#and starting value X1</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, chain)</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>        x[<span class="dv">1</span>] <span class="ot">&lt;-</span> X1</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>        u <span class="ot">&lt;-</span> <span class="fu">runif</span>(chain)</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>chain) {</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>            xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>            y<span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,xt,sigma)</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>            r1 <span class="ot">&lt;-</span> <span class="fu">cauchy</span>(y, theta, eta)</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>            r2 <span class="ot">&lt;-</span> <span class="fu">cauchy</span>(xt, theta, eta)</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>            r <span class="ot">&lt;-</span> r1 <span class="sc">/</span> r2</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> r) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span></span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>                 x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(x)</span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>    theta<span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>    eta<span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>    sigma<span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="dv">4</span>          <span class="co">#number of chains to generate</span></span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>    chain <span class="ot">&lt;-</span> <span class="dv">15000</span>      <span class="co">#length of chains</span></span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>    burn <span class="ot">&lt;-</span> <span class="dv">1000</span>       <span class="co">#burn-in length</span></span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">#choose overdispersed initial values</span></span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">#generate the chains</span></span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb107-39"><a href="#cb107-39" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>chain)</span>
<span id="cb107-40"><a href="#cb107-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb107-41"><a href="#cb107-41" aria-hidden="true" tabindex="-1"></a>        X[i, ] <span class="ot">&lt;-</span> <span class="fu">cauchy.chain</span>(theta,eta,chain,sigma,x0[i])</span>
<span id="cb107-42"><a href="#cb107-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-43"><a href="#cb107-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">#compute diagnostic statistics</span></span>
<span id="cb107-44"><a href="#cb107-44" aria-hidden="true" tabindex="-1"></a>    psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb107-45"><a href="#cb107-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb107-46"><a href="#cb107-46" aria-hidden="true" tabindex="-1"></a>        psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb107-47"><a href="#cb107-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-48"><a href="#cb107-48" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plot psi for the four chains</span></span>
<span id="cb107-49"><a href="#cb107-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb107-50"><a href="#cb107-50" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb107-51"><a href="#cb107-51" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>((burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>chain,psi[i, (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>chain],<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb107-52"><a href="#cb107-52" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="at">ylab=</span><span class="fu">bquote</span>(phi))</span>
<span id="cb107-53"><a href="#cb107-53" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb107-54"><a href="#cb107-54" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lines</span>(psi[i, (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>chain], <span class="at">col=</span>i)</span>
<span id="cb107-55"><a href="#cb107-55" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, chain)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>chain)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>        rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(rhat[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>chain], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>For 9.8</strong></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1111</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;coda&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a> f.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(n,a,b,chain,x0,y0) {</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Use the Gibbs sampler to generates a chain for f(x,y)</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>        <span class="co">#and starting value (x0,y0)</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>        Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,chain,<span class="dv">2</span>)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>        Z[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span> x0</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>        Z[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span> y0</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>chain) {</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>        Y <span class="ot">&lt;-</span> Z[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>        Z[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,Y)</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>        X<span class="ot">&lt;-</span> Z[i, <span class="dv">1</span>]</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>        Z[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X<span class="sc">+</span>a,n<span class="sc">-</span>X<span class="sc">+</span>b)</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(Z)</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># parameter of proposal distribution</span></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>    n<span class="ot">&lt;-</span> <span class="dv">20</span>; a<span class="ot">&lt;-</span> <span class="dv">2</span>; b<span class="ot">&lt;-</span> <span class="dv">2</span>; x0<span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">size=</span><span class="dv">4</span>,<span class="at">replace=</span>T); y0<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">4</span>); chain<span class="ot">&lt;-</span> <span class="dv">20000</span></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="dv">4</span>          <span class="co"># number of chains to generate</span></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>    burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># burn-in length</span></span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a>    z<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>k,chain)</span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># generate the chains</span></span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a>      z[(<span class="dv">2</span><span class="sc">*</span>s<span class="dv">-1</span>)<span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>s),]<span class="ot">&lt;-</span> <span class="fu">f.chain</span>(n,a,b,chain,x0[s],y0[s])</span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For X:</span></span>
<span id="cb112-30"><a href="#cb112-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute diagnostic statistics</span></span>
<span id="cb112-31"><a href="#cb112-31" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(z[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>),], <span class="dv">1</span>, cumsum))</span>
<span id="cb112-32"><a href="#cb112-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb112-33"><a href="#cb112-33" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb112-34"><a href="#cb112-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot the sequence of R-hat statistics</span></span>
<span id="cb112-35"><a href="#cb112-35" aria-hidden="true" tabindex="-1"></a>  rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, chain)</span>
<span id="cb112-36"><a href="#cb112-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>chain)</span>
<span id="cb112-37"><a href="#cb112-37" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb112-38"><a href="#cb112-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(rhat[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>chain], <span class="at">main=</span><span class="st">&#39;covergence for X&#39;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb112-39"><a href="#cb112-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For Y:</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute diagnostic statistics</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(z[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>),], <span class="dv">1</span>, cumsum))</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot the sequence of R-hat statistics</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>  rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, chain)</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>chain)</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(rhat[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>chain], <span class="at">main=</span><span class="st">&#39;covergence for Y&#39;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As we can see, the figures of <span class="math inline">\(\hat{R}\)</span> are lower than 1.2 after the length of chains are large enough.</p>
</div>
<div id="section-8" class="section level2">
<h2>2021-11-18</h2>
<p>11.3.<br />
<strong>The R procedure:</strong><br />
<strong>(a)</strong></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The original function calculates the value of the k-th term</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>kth<span class="ot">&lt;-</span> <span class="cf">function</span>(a,d,k){</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">/</span>(<span class="fu">factorial</span>(k)<span class="sc">*</span><span class="dv">2</span><span class="sc">^</span>k) <span class="sc">*</span> (<span class="fu">sqrt</span>(<span class="fu">t</span>(a) <span class="sc">%*%</span> a))<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)) <span class="sc">*</span> (<span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">gamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span>(<span class="fu">gamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The transformed function calculates the value of the kth term (when k and d are large)</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>per.kth<span class="ot">&lt;-</span> <span class="cf">function</span>(a,d,k){</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">/</span><span class="fu">factorial</span>(k) <span class="sc">*</span> <span class="fu">exp</span>((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">sqrt</span>(<span class="fu">t</span>(a) <span class="sc">%*%</span> a))<span class="sc">-</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><br />
<strong>(b)</strong></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>tol<span class="ot">&lt;-</span> .Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.5</span> <span class="co"># Setting accuracy</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>sum.k<span class="ot">&lt;-</span> <span class="cf">function</span>(a,d,M){</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  ktherm<span class="ot">&lt;-</span> <span class="fu">numeric</span>(M<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>M</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M<span class="sc">+</span><span class="dv">1</span>){</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  ktherm[i]<span class="ot">&lt;-</span> <span class="fu">per.kth</span>(a,d,k[i])</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ktherm[i]<span class="sc">&lt;</span> tol){</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(ktherm))</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><br />
<strong>(c)</strong></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>M1<span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>M2<span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;repeat 1000 times，sum=&#39;</span>,<span class="fu">sum.k</span>(a,d,M2),<span class="st">&#39;repeat 2000 times，sum=&#39;</span>,<span class="fu">sum.k</span>(a,d,M1))</span></code></pre></div>
<pre><code>## repeat 1000 times，sum= -0.003830223 repeat 2000 times，sum= -0.003830223</code></pre>
<p>This sum converges for <span class="math inline">\(a=(1,2)^T\)</span> when we assume <span class="math inline">\(d=100\)</span>.<br />
<br />
</p>
<p>11.5.<br />
<strong>The R procedure of 11.4:</strong></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>k0<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>Ak<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k0))</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k0)){</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span> k0[i]</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>Sk<span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">pt</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)<span class="sc">-</span><span class="fu">pt</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),k) <span class="co"># S_k(a)-S_{k-1}(a)</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>Ak[i]<span class="ot">&lt;-</span> <span class="fu">uniroot</span>(Sk,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))<span class="sc">$</span>root</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>The R procedure of 11.5:</strong></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>k0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>root<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k))</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k0)){</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span>k0[i]</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span> <span class="cf">function</span>(u,k){</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">+</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k)<span class="sc">^</span>(<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>int<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">integrate</span>(f,<span class="at">lower=</span><span class="dv">0</span>,<span class="at">upper=</span><span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),<span class="at">rel.tol=</span>.Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.25</span>,<span class="at">k=</span>k)<span class="sc">$</span>value)</span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>cha2<span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>(k<span class="dv">-1</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">int</span>(a,k<span class="dv">-1</span>)<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>k)<span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">int</span>(a,k)</span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>root[i]<span class="ot">&lt;-</span> <span class="fu">uniroot</span>(cha2,<span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">2</span>))<span class="sc">$</span>root</span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(k0,root,Ak)</span></code></pre></div>
<pre><code>##         k0     root       Ak
##  [1,]    4 1.492103 1.492103
##  [2,]    5 1.533554 1.533556
##  [3,]    6 1.562745 1.562744
##  [4,]    7 1.584430 1.584430
##  [5,]    8 1.601185 1.601185
##  [6,]    9 1.614522 1.614521
##  [7,]   10 1.625391 1.625390
##  [8,]   11 1.634420 1.634419
##  [9,]   12 1.642039 1.642038
## [10,]   13 1.648555 1.648554
## [11,]   14 1.654192 1.654190
## [12,]   15 1.659115 1.659114
## [13,]   16 1.663454 1.663452
## [14,]   17 1.667305 1.667303
## [15,]   18 1.670747 1.670745
## [16,]   19 1.673841 1.673840
## [17,]   20 1.676638 1.676637
## [18,]   21 1.679179 1.679178
## [19,]   22 1.681497 1.681496
## [20,]   23 1.683621 1.683620
## [21,]   24 1.685573 1.685572
## [22,]   25 1.687374 1.687373
## [23,]  100 1.720606 1.720608
## [24,]  500 1.729753 1.729755
## [25,] 1000 1.730905 1.730907</code></pre>
<p>We can find that the zero points of the equation in Q11.4 and Q11.5 are almost equal.<br />
</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
</div>
<div id="the-observed-data-mle" class="section level2">
<h2>The observed data MLE:</h2>
<p><span class="math display">\[L_{ob}(\lambda;t_i,T_j)=\Big(\prod\limits_{i=1}^{n_0}\dfrac{1}{\lambda}e^{-\frac{1}{\lambda}t_i}\Big)\Big(P(T_j&gt;\tau)\Big)^{10-n_0}=\Big(\prod\limits_{i=1}^{n_0}\dfrac{1}{\lambda}e^{-\frac{1}{\lambda}t_i}\Big)\Big(e^{-\frac{1}{\lambda}})^{10-n_0}\]</span></p>
<p><span class="math display">\[l_{ob}(\lambda;t_i)=\log L_{ob}(\lambda;t_i,T_j)=-n_0\log\lambda-\dfrac{1}{\lambda}\sum\limits_{i=1}^{n_0}t_i-\dfrac{10-n_0}{\lambda}\]</span></p>
<p><span class="math display">\[\hat{\lambda}=\arg\max~ l_{ob}(\lambda;t_i)\]</span></p>
<p><span class="math display">\[\dfrac{\partial l_{ob}(\lambda;t_i)}{\partial\lambda}=-\dfrac{n_0}{\lambda}+\dfrac{\sum\limits_{i=1}^{n_0}t_i}{\lambda^2}+\dfrac{10-n_0}{\lambda^2}=0~\Rightarrow~\hat{\lambda}=\dfrac{\sum\limits_{i=1}^{n_0}t_i+10-n_0}{n_0}=\dfrac{1}{n_0}\sum\limits_{i=1}^{10}Y_i\]</span></p>
</div>
<div id="the-em-algorithm-step" class="section level2">
<h2>The EM algorithm step:</h2>
<p><strong>step 1.</strong> Initiate: <span class="math inline">\(\lambda\)</span> with <span class="math inline">\(\lambda_0\)</span>.</p>
<p><strong>setp 2. E-step:</strong></p>
<p><span class="math inline">\(L_{EM}(\lambda;t_i,t_j)=\Big(\prod\limits_{i=1}^{n_0}\dfrac{1}{\lambda}e^{-\frac{1}{\lambda}t_i}\Big)\Big(\prod\limits_{j=n_0+1}^{n}\dfrac{1}{\lambda}e^{-\frac{1}{\lambda}t_j}\Big)\)</span>, where <span class="math inline">\(t_i\)</span> is the observed data, <span class="math inline">\(t_j\)</span> is the missing data.</p>
<p><span class="math inline">\(\log L_{EM}(\lambda;t_i,t_j)=-n\log\lambda-\dfrac{1}{\lambda}\sum\limits_{i=1}^{n_0}t_i-\dfrac{1}{\lambda}\sum\limits_{j=n_0+1}^{n}t_j\)</span></p>
<p><span class="math inline">\(E(t_j|t_i,\lambda_0)=\dfrac{E(t_jI(t_j&gt;1)|t_i,\lambda_0)}{EI(t_j&gt;1)}=\dfrac{\int_1^\infty t\frac{1}{\lambda_0}e^{-\frac{t}{\lambda_0}}dt}{e^{-\frac{1}{\lambda_0}}}=\dfrac{(1+\lambda_0)e^{-\frac{1}{\lambda_0}}}{e^{-\frac{1}{\lambda_0}}}=1+\lambda_0\)</span></p>
<p><span class="math inline">\(l_{EM}(\lambda;t_i)=E\Big(\log L_{EM}(\lambda;t_i,t_j)|t_i,\lambda_0\Big)=-n\log\lambda-\dfrac{1}{\lambda}\sum\limits_{i=1}^{n_0}t_i-\dfrac{n-n_0}{\lambda}(1+\lambda_0)\)</span></p>
<p><strong>step 3. M-step:</strong></p>
<p><span class="math inline">\(\dfrac{\partial l_{EM}(\lambda;t_i)}{\partial\lambda}=-\dfrac{n}{\lambda}+\dfrac{1}{\lambda^2}\sum\limits_{i=1}^{n_0}t_i+\dfrac{n-n_0}{\lambda^2}(1+\lambda_0)=0~\Rightarrow~\hat{\lambda}=\dfrac{\sum\limits_{i=1}^{n_0}t_i+(n-n_0)(1+\lambda_0)}{n}\)</span></p>
<p><strong>step 4. Iteration:</strong></p>
<p><span class="math inline">\(\lambda_{\infty}=\dfrac{\sum\limits_{i=1}^{n_0}t_i+(n-n_0)(1+\lambda_\infty)}{n}~\Rightarrow~\lambda_{\infty}=\dfrac{\sum\limits_{i=1}^{n_0}t_i+n-n_0}{n_0}=\dfrac{1}{n_0}\sum\limits_{i=1}^{10}Y_i\)</span></p>
<p>Then, the observed data MLE is the same as EM algorithm MLE.<br />
<strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats4)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>iden<span class="ot">&lt;-</span> <span class="cf">function</span>(x,tau){</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span> <span class="fu">sum</span>(x<span class="sc">==</span>tau)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  n0<span class="ot">&lt;-</span> <span class="fu">length</span>(x)<span class="sc">-</span>n</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>  sumx<span class="ot">&lt;-</span> <span class="fu">sum</span>(x)</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(n0)</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>x.ob<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>logMLE<span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">theta=</span><span class="dv">1</span>){</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">iden</span>(x.ob,<span class="dv">1</span>)<span class="sc">*</span><span class="fu">log</span>(theta)<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>theta<span class="sc">*</span><span class="fu">sum</span>(x.ob))</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span> <span class="fu">mle</span>(logMLE)</span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>lam.ob<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(<span class="fu">c</span>(fit<span class="sc">@</span>coef)) </span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>lam.gs<span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">iden</span>(x.ob,<span class="dv">1</span>)<span class="sc">*</span><span class="fu">sum</span>(x.ob) </span></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the EM algorithm to iterate out the value of lambda</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>lambda0<span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>tol<span class="ot">&lt;-</span> .Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.5</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>lam.EM<span class="ot">&lt;-</span> lambda0<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>  lambda0<span class="ot">&lt;-</span> (<span class="fu">sum</span>(x.ob)<span class="sc">+</span><span class="dv">3</span><span class="sc">*</span>lambda0)<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ((<span class="fu">abs</span>(lambda0<span class="sc">-</span>lam.EM)<span class="sc">/</span>lam.EM)<span class="sc">&lt;</span> tol) {</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>  lam.EM<span class="ot">&lt;-</span> lambda0</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(lam.ob,lam.EM)</span></code></pre></div>
<pre><code>##         lam.ob    lam.EM
## [1,] 0.9642705 0.9642857</code></pre>
<p>As we can see, the value of <span class="math inline">\(\lambda\)</span> estimated by E-M algorithm is very close to the observed data MLE.</p>
</div>
<div id="section-9" class="section level2">
<h2>2021-11-25</h2>
<p><strong>1.Exercises 1</strong><br />
<strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>trims<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.5</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims,<span class="cf">function</span>(trim) <span class="fu">mean</span>(x,<span class="at">trim=</span>trim))</span></code></pre></div>
<pre><code>## [[1]]
## [1] -0.6001549
## 
## [[2]]
## [1] 0.2051313
## 
## [[3]]
## [1] 0.1945539
## 
## [[4]]
## [1] 0.2326127</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims,mean,<span class="at">x=</span>x)</span></code></pre></div>
<pre><code>## [[1]]
## [1] -0.6001549
## 
## [[2]]
## [1] 0.2051313
## 
## [[3]]
## [1] 0.1945539
## 
## [[4]]
## [1] 0.2326127</code></pre>
<p>The “lapply(x,fun,…)” function applies the fun function to each element of x, which is equivalent to averaging each element of the trims array and the x data set, so here are two procedures The result is the same.<br />
</p>
<p><strong>1.Exercises 5</strong> <strong>The R procedure of Q3:</strong></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>mpg<span class="ot">&lt;-</span> mtcars<span class="sc">$</span>mpg</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>disp<span class="ot">&lt;-</span> mtcars<span class="sc">$</span>disp</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>wt<span class="ot">&lt;-</span> mtcars<span class="sc">$</span>wt</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>formulas<span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>  mpg<span class="sc">~</span>disp,</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>  mpg<span class="sc">~</span><span class="fu">I</span>(<span class="dv">1</span><span class="sc">/</span>disp),</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>  mpg<span class="sc">~</span>disp<span class="sc">+</span>wt,</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>  mpg<span class="sc">~</span><span class="fu">I</span>(<span class="dv">1</span><span class="sc">/</span>disp)<span class="sc">+</span>wt</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a><span class="co"># loop</span></span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)){</span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">lm</span>(<span class="fu">as.formula</span>(<span class="fu">as.character</span>(formulas[i]))))</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = as.formula(as.character(formulas[i])))
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = as.formula(as.character(formulas[i])))
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## Call:
## lm(formula = as.formula(as.character(formulas[i])))
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## Call:
## lm(formula = as.formula(as.character(formulas[i])))
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>mylm<span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas,lm)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="co"># R^2</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>rsq<span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(mylm,rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<p><strong>1.Exercises 5</strong> <strong>The R procedure of Q4:</strong></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>bootstrap<span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="cf">function</span>(i){</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  rows<span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars),<span class="at">rep=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="co"># loop</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="fu">seq_along</span>(bootstrap)){</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">lm</span>(mpg<span class="sc">~</span>disp,bootstrap[[b]]))</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ disp, data = bootstrap[[b]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.9864      -0.0427  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstrap[[b]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.72005     -0.04349  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstrap[[b]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.33634     -0.03414  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstrap[[b]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.05773     -0.04246  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstrap[[b]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.60750     -0.04687  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstrap[[b]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.67933     -0.04857  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstrap[[b]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.67555     -0.04494  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstrap[[b]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.08145     -0.04585  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstrap[[b]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.75773     -0.04158  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstrap[[b]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.82247     -0.03719</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply()</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>md<span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstrap,lm)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="co"># R^2</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>rsq<span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(md,rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.6885715
## 
## [[2]]
## [1] 0.6664638
## 
## [[3]]
## [1] 0.5446609
## 
## [[4]]
## [1] 0.6833908
## 
## [[5]]
## [1] 0.6780145
## 
## [[6]]
## [1] 0.8077152
## 
## [[7]]
## [1] 0.8286339
## 
## [[8]]
## [1] 0.7747802
## 
## [[9]]
## [1] 0.7535341
## 
## [[10]]
## [1] 0.7434605</code></pre>
<p><strong>2.Exercise 1</strong></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a) choose ‘trees’ data set</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>data<span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(trees) <span class="co"># The trees data set is of type &quot;matrix&quot; &quot;array&quot; and needs to be converted</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(data,sd,<span class="at">FUN.VALUE=</span><span class="fu">c</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##     Girth    Height    Volume 
##  3.138139  6.371813 16.437846</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># b) choose ‘iris’ data set. The last column &#39;Species&#39; is of type Factor</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(iris[(<span class="fu">vapply</span>(iris,class,<span class="fu">character</span>(<span class="dv">1</span>))<span class="sc">==</span><span class="st">&#39;numeric&#39;</span>)], sd,<span class="at">FUN.VALUE=</span><span class="fu">c</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
<p><strong>2. Exercise 7</strong></p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>boot_lm <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> mtcars[<span class="fu">sample</span>(<span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> T), ]</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">lm</span>(mpg <span class="sc">~</span> wt <span class="sc">+</span> disp, <span class="at">data =</span> dat))<span class="sc">$</span>r.square</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n, boot_lm))</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="fu">getOption</span>(<span class="st">&quot;cl.cores&quot;</span>, <span class="dv">4</span>))</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>({</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">parSapply</span>(cl,<span class="dv">1</span><span class="sc">:</span>n,boot_lm)</span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code></pre></div>
<p>Here you can use the “parSapply” function to achieve the effect of “mcsapply()”. But for “mcvapply()”, there is no corresponding function implementation in R.</p>
</div>
<div id="section-10" class="section level2">
<h2>2021-12-02</h2>
<p><strong>1.</strong><br />
<strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>using namespace Rcpp;</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span><span class="er">/</span><span class="st">&#39; @title A Gibbs sampler using Rcpp</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="st">//&#39;</span> <span class="sc">@</span>description A Gibbs sampler using Rcpp</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span><span class="er">/</span><span class="st">&#39; @param N the number of samples</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="st">//&#39;</span> <span class="sc">@</span>return a random <span class="fu">sample</span> (x,y)</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span><span class="er">/</span><span class="st">&#39; @examples</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="st">//&#39;</span> \dontrun{</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span><span class="er">/</span><span class="st">&#39; }</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a><span class="st">//&#39;</span> <span class="sc">@</span>export</span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span><span class="er">/</span> [[Rcpp<span class="sc">::</span>export]]</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>NumericMatrix <span class="fu">GibbsC</span>(int N){</span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>  NumericMatrix <span class="fu">mat</span>(N,<span class="dv">2</span>); </span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a>  double x<span class="ot">=</span><span class="dv">1</span>,y<span class="ot">=</span><span class="fl">0.5</span>; <span class="sc">/</span><span class="er">*</span>initial<span class="sc">*</span><span class="er">/</span></span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a>  double a<span class="ot">=</span><span class="dv">2</span>,b<span class="ot">=</span><span class="dv">3</span>; </span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a>  int n<span class="ot">=</span><span class="dv">20</span>; </span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (int <span class="at">i=</span><span class="dv">0</span>; i<span class="sc">&lt;</span>N; i<span class="sc">++</span>){</span>
<span id="cb141-21"><a href="#cb141-21" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)[<span class="dv">0</span>];</span>
<span id="cb141-22"><a href="#cb141-22" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)[<span class="dv">0</span>];</span>
<span id="cb141-23"><a href="#cb141-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mat</span>(i,<span class="dv">0</span>) <span class="ot">=</span> x;</span>
<span id="cb141-24"><a href="#cb141-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mat</span>(i,<span class="dv">1</span>) <span class="ot">=</span> y;</span>
<span id="cb141-25"><a href="#cb141-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb141-26"><a href="#cb141-26" aria-hidden="true" tabindex="-1"></a>  return mat;</span>
<span id="cb141-27"><a href="#cb141-27" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><br />
</p>
<p><strong>2.</strong><br />
<strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1202</span>)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="co"># use R</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>chain<span class="ot">&lt;-</span> <span class="cf">function</span>(N){</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) </span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>Z[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># initial</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>Z[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> Z[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>Z[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,Y)</span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span> Z[i, <span class="dv">1</span>]</span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a>Z[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X<span class="sc">+</span>a,n<span class="sc">-</span>X<span class="sc">+</span>b)</span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(Z)</span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Rcpp&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(StatComp21024) </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="co">#qqplots of x and y</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(<span class="fu">chain</span>(<span class="dv">500</span>)[,<span class="dv">1</span>],<span class="fu">GibbsC</span>(<span class="dv">500</span>)[,<span class="dv">1</span>],<span class="at">main=</span><span class="st">&#39;qqplot of x&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(<span class="fu">chain</span>(<span class="dv">500</span>)[,<span class="dv">2</span>],<span class="fu">GibbsC</span>(<span class="dv">500</span>)[,<span class="dv">2</span>],<span class="at">main=</span><span class="st">&#39;qqplot of y&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>3.</strong><br />
<strong>The R procedure:</strong></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1202</span>)</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.1.2 来建造的</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(StatComp21024) </span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(chain1<span class="ot">&lt;-</span> <span class="fu">chain</span>(N),chain2<span class="ot">&lt;-</span> <span class="fu">GibbsC</span>(N))</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)</span></code></pre></div>
<pre><code>##                  expr    min      lq     mean median     uq     max neval
## 1  chain1 &lt;- chain(N) 3227.3 6043.75 9032.042 6625.7 9093.8 43046.7   100
## 2 chain2 &lt;- GibbsC(N)  269.3  426.65  501.513  459.8  585.0  1185.7   100</code></pre>
<p><br />
</p>
<p><strong>4.</strong> For the second question, use the “qqplot” function to draw a random number scatter plot generated by Rcpp and pure R language. Observing the image, you can find that whether it is a random variable of x or y, the relationship between the two is very close to “y=x” image, so it can be judged that the data distribution generated by the two methods is roughly the same. For the third question, use the “microbenchmark” function to calculate the time for Rcpp and R language to generate data. From the results, it can be seen that the function calculation time of Rcpp is an order of magnitude less than that of the direct R language calculation, so it can reduce the running time and increase the calculation efficient.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
